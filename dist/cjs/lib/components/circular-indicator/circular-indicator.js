"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.CircularIndicator = exports.ProgressColorsRange = exports.CircularIndicatorTextVariation = exports.CircularIndicatorTextSize = void 0;
var tslib_1 = require("tslib");
var jsx_runtime_1 = require("react/jsx-runtime");
var match_size_1 = require("../../utils/match-size");
var flex_row_1 = tslib_1.__importDefault(require("../flex-row/flex-row"));
var styled_components_1 = tslib_1.__importDefault(require("styled-components"));
var text_1 = tslib_1.__importDefault(require("../text/text"));
var CircularIndicatorTextSize;
(function (CircularIndicatorTextSize) {
    CircularIndicatorTextSize[CircularIndicatorTextSize["small"] = 1] = "small";
    CircularIndicatorTextSize[CircularIndicatorTextSize["default"] = 2] = "default";
})(CircularIndicatorTextSize = exports.CircularIndicatorTextSize || (exports.CircularIndicatorTextSize = {}));
exports.CircularIndicatorTextVariation = (_a = {},
    _a[CircularIndicatorTextSize.small] = 'darkGray',
    _a[CircularIndicatorTextSize.default] = 'black',
    _a);
var StyledText = (0, styled_components_1.default)(text_1.default)(function (_a) {
    var theme = _a.theme, _b = _a.size, size = _b === void 0 ? 3 : _b, textSize = _a.textSize;
    return ({
        fontWeight: (0, match_size_1.matchSize)({
            1: theme.typography.fontWeight.semiBold,
            2: theme.typography.fontWeight.medium,
            3: theme.typography.fontWeight.regular,
        }, size),
        fontSize: (0, match_size_1.matchSize)({
            1: '0.813rem',
            2: '0.875rem',
        }, textSize),
        lineHeight: '1.25rem',
    });
});
exports.ProgressColorsRange = [
    { id: 1, limit: 0, color: 'E6332A' },
    { id: 2, limit: 0.25, color: 'ED8417' },
    { id: 3, limit: 0.5, color: 'F1BF0B' },
    { id: 4, limit: 0.75, color: 'BBDE31' },
    { id: 5, limit: 0.99, color: '86DE56' },
    { id: 6, limit: 1, color: '31DE91' },
];
var calculatePerfomanceGradientColor = function (progress) {
    var PROGRESS_MINIMUM = 95;
    var PROGRESS_MAXIMUM = 100;
    if (progress < PROGRESS_MINIMUM) {
        return "#".concat(exports.ProgressColorsRange[0].color);
    }
    var ratio = (progress - PROGRESS_MINIMUM) / (PROGRESS_MAXIMUM - PROGRESS_MINIMUM);
    var firstGradientItem = exports.ProgressColorsRange.find(function (range) { return ratio <= range.limit; });
    var firstGradientColor = firstGradientItem.color;
    if (firstGradientItem.id === exports.ProgressColorsRange.length) {
        return "#".concat(firstGradientColor);
    }
    var secondGradientColor = exports.ProgressColorsRange.find(function (range) { return range.id === firstGradientItem.id + 1; }).color;
    var hex = function (x) {
        return x.toString(16).padStart(2, '0');
    };
    var r = Math.ceil(parseInt(firstGradientColor.substring(0, 2), 16) * ratio +
        parseInt(secondGradientColor.substring(0, 2), 16) * (1 - ratio));
    var g = Math.ceil(parseInt(firstGradientColor.substring(2, 4), 16) * ratio +
        parseInt(secondGradientColor.substring(2, 4), 16) * (1 - ratio));
    var b = Math.ceil(parseInt(firstGradientColor.substring(4, 6), 16) * ratio +
        parseInt(secondGradientColor.substring(4, 6), 16) * (1 - ratio));
    var color = hex(r) + hex(g) + hex(b);
    return "#".concat(color);
};
/**
 * @example
 * <CircularIndicator size="medium" progress={0 - 100} />
 */
function CircularIndicator(_a) {
    var size = _a.size, progress = _a.progress, textSize = _a.textSize;
    var _b = (0, match_size_1.matchSize)({
        medium: { stroke: 4, radius: 12 },
    }, size), stroke = _b.stroke, radius = _b.radius;
    // validation 0 - 100
    if (progress == null || progress < 0 || progress > 100) {
        progress = 0;
    }
    var strokeRadius = radius - stroke / 2;
    var strokeCircumference = strokeRadius * 2 * Math.PI;
    var strokeDashoffset = strokeCircumference - (progress / 100) * strokeCircumference;
    var roundedProgress = progress.toPrecision(3);
    var color = calculatePerfomanceGradientColor(progress);
    return ((0, jsx_runtime_1.jsxs)(flex_row_1.default, tslib_1.__assign({ align: "center" }, { children: [(0, jsx_runtime_1.jsx)("svg", tslib_1.__assign({ height: radius * 2, width: radius * 2 }, { children: (0, jsx_runtime_1.jsx)("circle", { stroke: color, fill: "transparent", strokeWidth: stroke, strokeDasharray: strokeCircumference + ' ' + strokeCircumference, style: {
                        strokeDashoffset: strokeDashoffset,
                        transition: 'stroke-dashoffset 0.35s',
                        transform: 'rotate(-90deg)',
                        transformOrigin: '50% 50%',
                    }, r: strokeRadius, cx: radius, cy: radius }) })), (0, jsx_runtime_1.jsxs)(StyledText, tslib_1.__assign({ size: 3, style: { marginLeft: 8 }, textSize: textSize, variation: exports.CircularIndicatorTextVariation[textSize] }, { children: [roundedProgress, "%"] }))] })));
}
exports.CircularIndicator = CircularIndicator;
exports.default = CircularIndicator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2lyY3VsYXItaW5kaWNhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9jb21wb25lbnRzL2NpcmN1bGFyLWluZGljYXRvci9jaXJjdWxhci1pbmRpY2F0b3IudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUdBLHFEQUFtRDtBQUNuRCwwRUFBMkM7QUFDM0MsZ0ZBQXVDO0FBQ3ZDLDhEQUFtRDtBQVFuRCxJQUFZLHlCQUdYO0FBSEQsV0FBWSx5QkFBeUI7SUFDbkMsMkVBQVcsQ0FBQTtJQUNYLCtFQUFhLENBQUE7QUFDZixDQUFDLEVBSFcseUJBQXlCLEdBQXpCLGlDQUF5QixLQUF6QixpQ0FBeUIsUUFHcEM7QUFFWSxRQUFBLDhCQUE4QjtJQUl6QyxHQUFDLHlCQUF5QixDQUFDLEtBQUssSUFBRyxVQUFVO0lBQzdDLEdBQUMseUJBQXlCLENBQUMsT0FBTyxJQUFHLE9BQU87UUFDNUM7QUFFRixJQUFNLFVBQVUsR0FBRyxJQUFBLDJCQUFNLEVBQUMsY0FBSSxDQUFDLENBTTdCLFVBQUMsRUFBNkI7UUFBM0IsS0FBSyxXQUFBLEVBQUUsWUFBUSxFQUFSLElBQUksbUJBQUcsQ0FBQyxLQUFBLEVBQUUsUUFBUSxjQUFBO0lBQU8sT0FBQSxDQUFDO1FBQ2xDLFVBQVUsRUFBRSxJQUFBLHNCQUFTLEVBQ25CO1lBQ0UsQ0FBQyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLFFBQVE7WUFDdkMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLE1BQU07WUFDckMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLE9BQU87U0FDdkMsRUFDRCxJQUFJLENBQ0w7UUFDRCxRQUFRLEVBQUUsSUFBQSxzQkFBUyxFQUNqQjtZQUNFLENBQUMsRUFBRSxVQUFVO1lBQ2IsQ0FBQyxFQUFFLFVBQVU7U0FDZCxFQUNELFFBQVEsQ0FDVDtRQUNELFVB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LGVBQWUsR0FBRyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2hELElBQU0sS0FBSyxHQUFHLGdDQUFnQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBRXpELE9BQU8sQ0FDTCx3QkFBQyxrQkFBTyxxQkFBQyxLQUFLLEVBQUMsUUFBUSxpQkFDckIsaURBQUssTUFBTSxFQUFFLE1BQU0sR0FBRyxDQUFDLEVBQUUsS0FBSyxFQUFFLE1BQU0sR0FBRyxDQUFDLGdCQUN4QyxtQ0FDRSxNQUFNLEVBQUUsS0FBSyxFQUNiLElBQUksRUFBQyxhQUFhLEVBQ2xCLFdBQVcsRUFBRSxNQUFNLEVBQ25CLGVBQWUsRUFBRSxtQkFBbUIsR0FBRyxHQUFHLEdBQUcsbUJBQW1CLEVBQ2hFLEtBQUssRUFBRTt3QkFDTCxnQkFBZ0Isa0JBQUE7d0JBQ2hCLFVBQVUsRUFBRSx5QkFBeUI7d0JBQ3JDLFNBQVMsRUFBRSxnQkFBZ0I7d0JBQzNCLGVBQWUsRUFBRSxTQUFTO3FCQUMzQixFQUNELENBQUMsRUFBRSxZQUFZLEVBQ2YsRUFBRSxFQUFFLE1BQU0sRUFDVixFQUFFLEVBQUUsTUFBTSxHQUNWLElBQ0UsRUFDTix3QkFBQyxVQUFVLHFCQUNULElBQUksRUFBRSxDQUFDLEVBQ1AsS0FBSyxFQUFFLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxFQUN4QixRQUFRLEVBQUUsUUFBUSxFQUNsQixTQUFTLEVBQUUsc0NBQThCLENBQUMsUUFBUSxDQUFDLGlCQUVsRCxlQUFlLFVBQ0wsS0FDTCxDQUNYLENBQUM7QUFDSixDQUFDO0FBdERELDhDQXNEQztBQUVELGtCQUFlLGlCQUFpQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcclxuXHJcbmltcG9ydCB7IEJhc2VQcm9wcyB9IGZyb20gJy4uLy4uL3R5cGVzJztcclxuaW1wb3J0IHsgbWF0Y2hTaXplIH0gZnJvbSAnLi4vLi4vdXRpbHMvbWF0Y2gtc2l6ZSc7XHJcbmltcG9ydCBGbGV4Um93IGZyb20gJy4uL2ZsZXgtcm93L2ZsZXgtcm93JztcclxuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XHJcbmltcG9ydCBUZXh0LCB7IFRleHRWYXJpYXRpb24gfSBmcm9tICcuLi90ZXh0L3RleHQnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDaXJjdWxhckluZGljYXRvclByb3BzIGV4dGVuZHMgQmFzZVByb3BzIHtcclxuICBzaXplOiAnbWVkaXVtJztcclxuICBwcm9ncmVzczogbnVtYmVyO1xyXG4gIHRleHRTaXplOiAxIHwgMjtcclxufVxyXG5cclxuZXhwb3J0IGVudW0gQ2lyY3VsYXJJbmRpY2F0b3JUZXh0U2l6ZSB7XHJcbiAgJ3NtYWxsJyA9IDEsXHJcbiAgJ2RlZmF1bHQnID0gMixcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IENpcmN1bGFySW5kaWNhdG9yVGV4dFZhcmlhdGlvbjoge1xyXG4gIFtDaXJjdWxhckluZGljYXRvclRleHRTaXplLnNtYWxsXTogVGV4dFZhcmlhdGlvbjtcclxuICBbQ2lyY3VsYXJJbmRpY2F0b3JUZXh0U2l6ZS5kZWZhdWx0XTogVGV4dFZhcmlhdGlvbjtcclxufSA9IHtcclxuICBbQ2lyY3VsYXJJbmRpY2F0b3JUZXh0U2l6ZS5zbWFsbF06ICdkYXJrR3JheScsXHJcbiAgW0NpcmN1bGFySW5kaWNhdG9yVGV4dFNpemUuZGVmYXVsdF06ICdibGFjaycsXHJcbn07XHJcblxyXG5jb25zdCBTdHlsZWRUZXh0ID0gc3R5bGVkKFRleHQpPHtcclxuICAgIHNpemU6IDEgfCAyIHwgMztcclxuICAgIHNjYWxlPzogJ3hzJyB8ICdzbScgfCAnbWQnIHwgJ2xnJztcclxuICAgIGxpbmVIZWlnaHQ/OiAneHMnIHwgJ3NtJztcclxuICAgIHRleHRTaXplOiAxIHwgMlxyXG59PihcclxuICAoeyB0aGVtZSwgc2l6ZSA9IDMsIHRleHRTaXplIH0pID0+ICh7XHJcbiAgICBmb250V2VpZ2h0OiBtYXRjaFNpemUoXHJcbiAgICAgIHtcclxuICAgICAgICAxOiB0aGVtZS50eXBvZ3JhcGh5LmZvbnRXZWlnaHQuc2VtaUJvbGQsXHJcbiAgICAgICAgMjogdGhlbWUudHlwb2dyYXBoeS5mb250V2VpZ2h0Lm1lZGl1bSxcclxuICAgICAgICAzOiB0aGVtZS50eXBvZ3JhcGh5LmZvbnRXZWlnaHQucmVndWxhcixcclxuICAgICAgfSxcclxuICAgICAgc2l6ZVxyXG4gICAgKSxcclxuICAgIGZvbnRTaXplOiBtYXRjaFNpemUoXHJcbiAgICAgIHtcclxuICAgICAgICAxOiAnMC44MTNyZW0nLFxyXG4gICAgICAgIDI6ICcwLjg3NXJlbScsXHJcbiAgICAgIH0sXHJcbiAgICAgIHRleHRTaXplXHJcbiAgICApLFxyXG4gICAgbGluZUhlaWdodDogJzEuMjVyZW0nLFxyXG4gIH0pXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgUHJvZ3Jlc3NDb2xvcnNSYW5nZSA9IFtcclxuICB7IGlkOiAxLCBsaW1pdDogMCwgY29sb3I6ICdFNjMzMkEnIH0sXHJcbiAgeyBpZDogMiwgbGltaXQ6IDAuMjUsIGNvbG9yOiAnRUQ4NDE3JyB9LFxyXG4gIHsgaWQ6IDMsIGxpbWl0OiAwLjUsIGNvbG9yOiAnRjFCRjBCJyB9LFxyXG4gIHsgaWQ6IDQsIGxpbWl0OiAwLjc1LCBjb2xvcjogJ0JCREUzMScgfSxcclxuICB7IGlkOiA1LCBsaW1pdDogMC45OSwgY29sb3I6ICc4NkRFNTYnIH0sXHJcbiAgeyBpZDogNiwgbGltaXQ6IDEsIGNvbG9yOiAnMzFERTkxJyB9LFxyXG5dO1xyXG5cclxuY29uc3QgY2FsY3VsYXRlUGVyZm9tYW5jZUdyYWRpZW50Q29sb3IgPSAocHJvZ3Jlc3MpID0+IHtcclxuICBjb25zdCBQUk9HUkVTU19NSU5JTVVNID0gOTU7XHJcbiAgY29uc3QgUFJPR1JFU1NfTUFYSU1VTSA9IDEwMDtcclxuXHJcbiAgaWYgKHByb2dyZXNzIDwgUFJPR1JFU1NfTUlOSU1VTSkge1xyXG4gICAgcmV0dXJuIGAjJHtQcm9ncmVzc0NvbG9yc1JhbmdlWzBdLmNvbG9yfWA7XHJcbiAgfVxyXG5cclxuICBjb25zdCByYXRpbyA9XHJcbiAgICAocHJvZ3Jlc3MgLSBQUk9HUkVTU19NSU5JTVVNKSAvIChQUk9HUkVTU19NQVhJTVVNIC0gUFJPR1JFU1NfTUlOSU1VTSk7XHJcblxyXG4gIGNvbnN0IGZpcnN0R3JhZGllbnRJdGVtID0gUHJvZ3Jlc3NDb2xvcnNSYW5nZS5maW5kKFxyXG4gICAgKHJhbmdlKSA9PiByYXRpbyA8PSByYW5nZS5saW1pdFxyXG4gICk7XHJcblxyXG4gIGNvbnN0IGZpcnN0R3JhZGllbnRDb2xvciA9IGZpcnN0R3JhZGllbnRJdGVtIS5jb2xvcjtcclxuXHJcbiAgaWYgKGZpcnN0R3JhZGllbnRJdGVtIS5pZCA9PT0gUHJvZ3Jlc3NDb2xvcnNSYW5nZS5sZW5ndGgpIHtcclxuICAgIHJldHVybiBgIyR7Zmlyc3RHcmFkaWVudENvbG9yfWA7XHJcbiAgfVxyXG5cclxuICBjb25zdCBzZWNvbmRHcmFkaWVudENvbG9yID0gUHJvZ3Jlc3NDb2xvcnNSYW5nZS5maW5kKFxyXG4gICAgKHJhbmdlKSA9PiByYW5nZS5pZCA9PT0gZmlyc3RHcmFkaWVudEl0ZW0hLmlkICsgMVxyXG4gICkhLmNvbG9yO1xyXG5cclxuICBjb25zdCBoZXggPSAoeCkgPT4ge1xyXG4gICAgcmV0dXJuIHgudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJyk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgciA9IE1hdGguY2VpbChcclxuICAgIHBhcnNlSW50KGZpcnN0R3JhZGllbnRDb2xvci5zdWJzdHJpbmcoMCwgMiksIDE2KSAqIHJhdGlvICtcclxuICAgICAgcGFyc2VJbnQoc2Vjb25kR3JhZGllbnRDb2xvci5zdWJzdHJpbmcoMCwgMiksIDE2KSAqICgxIC0gcmF0aW8pXHJcbiAgKTtcclxuICBjb25zdCBnID0gTWF0aC5jZWlsKFxyXG4gICAgcGFyc2VJbnQoZmlyc3RHcmFkaWVudENvbG9yLnN1YnN0cmluZygyLCA0KSwgMTYpICogcmF0aW8gK1xyXG4gICAgICBwYXJzZUludChzZWNvbmRHcmFkaWVudENvbG9yLnN1YnN0cmluZygyLCA0KSwgMTYpICogKDEgLSByYXRpbylcclxuICApO1xyXG4gIGNvbnN0IGIgPSBNYXRoLmNlaWwoXHJcbiAgICBwYXJzZUludChmaXJzdEdyYWRpZW50Q29sb3Iuc3Vic3RyaW5nKDQsIDYpLCAxNikgKiByYXRpbyArXHJcbiAgICAgIHBhcnNlSW50KHNlY29uZEdyYWRpZW50Q29sb3Iuc3Vic3RyaW5nKDQsIDYpLCAxNikgKiAoMSAtIHJhdGlvKVxyXG4gICk7XHJcbiAgY29uc3QgY29sb3IgPSBoZXgocikgKyBoZXgoZykgKyBoZXgoYik7XHJcblxyXG4gIHJldHVybiBgIyR7Y29sb3J9YDtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiA8Q2lyY3VsYXJJbmRpY2F0b3Igc2l6ZT1cIm1lZGl1bVwiIHByb2dyZXNzPXswIC0gMTAwfSAvPlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIENpcmN1bGFySW5kaWNhdG9yKHtcclxuICBzaXplLFxyXG4gIHByb2dyZXNzLFxyXG4gIHRleHRTaXplLFxyXG59OiBDaXJjdWxhckluZGljYXRvclByb3BzKSB7XHJcbiAgY29uc3QgeyBzdHJva2UsIHJhZGl1cyB9ID0gbWF0Y2hTaXplKFxyXG4gICAge1xyXG4gICAgICBtZWRpdW06IHsgc3Ryb2tlOiA0LCByYWRpdXM6IDEyIH0sXHJcbiAgICB9LFxyXG4gICAgc2l6ZVxyXG4gICk7XHJcblxyXG4gIC8vIHZhbGlkYXRpb24gMCAtIDEwMFxyXG4gIGlmIChwcm9ncmVzcyA9PSBudWxsIHx8IHByb2dyZXNzIDwgMCB8fCBwcm9ncmVzcyA+IDEwMCkge1xyXG4gICAgcHJvZ3Jlc3MgPSAwO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgc3Ryb2tlUmFkaXVzID0gcmFkaXVzIC0gc3Ryb2tlIC8gMjtcclxuICBjb25zdCBzdHJva2VDaXJjdW1mZXJlbmNlID0gc3Ryb2tlUmFkaXVzICogMiAqIE1hdGguUEk7XHJcbiAgY29uc3Qgc3Ryb2tlRGFzaG9mZnNldCA9XHJcbiAgICBzdHJva2VDaXJjdW1mZXJlbmNlIC0gKHByb2dyZXNzIC8gMTAwKSAqIHN0cm9rZUNpcmN1bWZlcmVuY2U7XHJcblxyXG4gIGNvbnN0IHJvdW5kZWRQcm9ncmVzcyA9IHByb2dyZXNzLnRvUHJlY2lzaW9uKDMpO1xyXG4gIGNvbnN0IGNvbG9yID0gY2FsY3VsYXRlUGVyZm9tYW5jZUdyYWRpZW50Q29sb3IocHJvZ3Jlc3MpO1xyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPEZsZXhSb3cgYWxpZ249XCJjZW50ZXJcIj5cclxuICAgICAgPHN2ZyBoZWlnaHQ9e3JhZGl1cyAqIDJ9IHdpZHRoPXtyYWRpdXMgKiAyfT5cclxuICAgICAgICA8Y2lyY2xlXHJcbiAgICAgICAgICBzdHJva2U9e2NvbG9yfVxyXG4gICAgICAgICAgZmlsbD1cInRyYW5zcGFyZW50XCJcclxuICAgICAgICAgIHN0cm9rZVdpZHRoPXtzdHJva2V9XHJcbiAgICAgICAgICBzdHJva2VEYXNoYXJyYXk9e3N0cm9rZUNpcmN1bWZlcmVuY2UgKyAnICcgKyBzdHJva2VDaXJjdW1mZXJlbmNlfVxyXG4gICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgc3Ryb2tlRGFzaG9mZnNldCxcclxuICAgICAgICAgICAgdHJhbnNpdGlvbjogJ3N0cm9rZS1kYXNob2Zmc2V0IDAuMzVzJyxcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiAncm90YXRlKC05MGRlZyknLFxyXG4gICAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW46ICc1MCUgNTAlJyxcclxuICAgICAgICAgIH19XHJcbiAgICAgICAgICByPXtzdHJva2VSYWRpdXN9XHJcbiAgICAgICAgICBjeD17cmFkaXVzfVxyXG4gICAgICAgICAgY3k9e3JhZGl1c31cclxuICAgICAgICAvPlxyXG4gICAgICA8L3N2Zz5cclxuICAgICAgPFN0eWxlZFRleHRcclxuICAgICAgICBzaXplPXszfVxyXG4gICAgICAgIHN0eWxlPXt7IG1hcmdpbkxlZnQ6IDggfX1cclxuICAgICAgICB0ZXh0U2l6ZT17dGV4dFNpemV9XHJcbiAgICAgICAgdmFyaWF0aW9uPXtDaXJjdWxhckluZGljYXRvclRleHRWYXJpYXRpb25bdGV4dFNpemVdfVxyXG4gICAgICA+XHJcbiAgICAgICAge3JvdW5kZWRQcm9ncmVzc30lXHJcbiAgICAgIDwvU3R5bGVkVGV4dD5cclxuICAgIDwvRmxleFJvdz5cclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDaXJjdWxhckluZGljYXRvcjtcclxuIl19