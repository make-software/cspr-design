import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { matchSize } from '../../utils/match-size';
import FlexRow from '../flex-row/flex-row';
import styled from 'styled-components';
import Text from '../text/text';
export var CircularIndicatorTextSize;
(function (CircularIndicatorTextSize) {
    CircularIndicatorTextSize[CircularIndicatorTextSize["small"] = 1] = "small";
    CircularIndicatorTextSize[CircularIndicatorTextSize["default"] = 2] = "default";
})(CircularIndicatorTextSize || (CircularIndicatorTextSize = {}));
export const CircularIndicatorTextVariation = {
    [CircularIndicatorTextSize.small]: 'darkGray',
    [CircularIndicatorTextSize.default]: 'black',
};
const StyledText = styled(Text)(({ theme, size = 3, textSize }) => ({
    fontWeight: matchSize({
        1: theme.typography.fontWeight.semiBold,
        2: theme.typography.fontWeight.medium,
        3: theme.typography.fontWeight.regular,
    }, size),
    fontSize: matchSize({
        1: '0.813rem',
        2: '0.875rem',
    }, textSize),
    lineHeight: '1.25rem',
}));
export const ProgressColorsRange = [
    { id: 1, limit: 0, color: 'E6332A' },
    { id: 2, limit: 0.25, color: 'ED8417' },
    { id: 3, limit: 0.5, color: 'F1BF0B' },
    { id: 4, limit: 0.75, color: 'BBDE31' },
    { id: 5, limit: 0.99, color: '86DE56' },
    { id: 6, limit: 1, color: '31DE91' },
];
const calculatePerfomanceGradientColor = (progress) => {
    const PROGRESS_MINIMUM = 95;
    const PROGRESS_MAXIMUM = 100;
    if (progress < PROGRESS_MINIMUM) {
        return `#${ProgressColorsRange[0].color}`;
    }
    const ratio = (progress - PROGRESS_MINIMUM) / (PROGRESS_MAXIMUM - PROGRESS_MINIMUM);
    const firstGradientItem = ProgressColorsRange.find((range) => ratio <= range.limit);
    const firstGradientColor = firstGradientItem.color;
    if (firstGradientItem.id === ProgressColorsRange.length) {
        return `#${firstGradientColor}`;
    }
    const secondGradientColor = ProgressColorsRange.find((range) => range.id === firstGradientItem.id + 1).color;
    const hex = (x) => {
        return x.toString(16).padStart(2, '0');
    };
    const r = Math.ceil(parseInt(firstGradientColor.substring(0, 2), 16) * ratio +
        parseInt(secondGradientColor.substring(0, 2), 16) * (1 - ratio));
    const g = Math.ceil(parseInt(firstGradientColor.substring(2, 4), 16) * ratio +
        parseInt(secondGradientColor.substring(2, 4), 16) * (1 - ratio));
    const b = Math.ceil(parseInt(firstGradientColor.substring(4, 6), 16) * ratio +
        parseInt(secondGradientColor.substring(4, 6), 16) * (1 - ratio));
    const color = hex(r) + hex(g) + hex(b);
    return `#${color}`;
};
/**
 * @example
 * <CircularIndicator size="medium" progress={0 - 100} />
 */
export function CircularIndicator({ size, progress, textSize, title }) {
    const { stroke, radius } = matchSize({
        medium: { stroke: 4, radius: 12 },
    }, size);
    // validation 0 - 100
    if (progress == null || progress < 0 || progress > 100) {
        progress = 0;
    }
    const strokeRadius = radius - stroke / 2;
    const strokeCircumference = strokeRadius * 2 * Math.PI;
    const strokeDashoffset = strokeCircumference - (progress / 100) * strokeCircumference;
    const roundedProgress = progress.toPrecision(3);
    const color = calculatePerfomanceGradientColor(progress);
    return (_jsxs(FlexRow, { align: "center", tag: "span", children: [_jsxs("svg", { height: radius * 2, width: radius * 2, children: [_jsx("title", { children: title }), _jsx("circle", { stroke: color, fill: "transparent", strokeWidth: stroke, strokeDasharray: strokeCircumference + ' ' + strokeCircumference, style: {
                            strokeDashoffset,
                            transition: 'stroke-dashoffset 0.35s',
                            transform: 'rotate(-90deg)',
                            transformOrigin: '50% 50%',
                        }, r: strokeRadius, cx: radius, cy: radius })] }), _jsxs(StyledText, { size: 3, style: { marginLeft: 8 }, textSize: textSize, variation: CircularIndicatorTextVariation[textSize], children: [roundedProgress, "%"] })] }));
}
export default CircularIndicator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2lyY3VsYXItaW5kaWNhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9jb21wb25lbnRzL2NpcmN1bGFyLWluZGljYXRvci9jaXJjdWxhci1pbmRpY2F0b3IudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFHQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDbkQsT0FBTyxPQUFPLE1BQU0sc0JBQXNCLENBQUM7QUFDM0MsT0FBTyxNQUFNLE1BQU0sbUJBQW1CLENBQUM7QUFDdkMsT0FBTyxJQUF1QixNQUFNLGNBQWMsQ0FBQztBQVNuRCxNQUFNLENBQU4sSUFBWSx5QkFHWDtBQUhELFdBQVkseUJBQXlCO0lBQ25DLDJFQUFXLENBQUE7SUFDWCwrRUFBYSxDQUFBO0FBQ2YsQ0FBQyxFQUhXLHlCQUF5QixLQUF6Qix5QkFBeUIsUUFHcEM7QUFFRCxNQUFNLENBQUMsTUFBTSw4QkFBOEIsR0FHdkM7SUFDRixDQUFDLHlCQUF5QixDQUFDLEtBQUssQ0FBQyxFQUFFLFVBQVU7SUFDN0MsQ0FBQyx5QkFBeUIsQ0FBQyxPQUFPLENBQUMsRUFBRSxPQUFPO0NBQzdDLENBQUM7QUFFRixNQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLENBTTdCLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxHQUFHLENBQUMsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUNsQyxVQUFVLEVBQUUsU0FBUyxDQUNuQjtRQUNFLENBQUMsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxRQUFRO1FBQ3ZDLENBQUMsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxNQUFNO1FBQ3JDLENBQUMsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxPQUFPO0tBQ3ZDLEVBQ0QsSUFBSSxDQUNMO0lBQ0QsUUFBUSxFQUFFLFNBQVMsQ0FDakI7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SUFDdkQsTUFBTSxnQkFBZ0IsR0FDcEIsbUJBQW1CLEdBQUcsQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLEdBQUcsbUJBQW1CLENBQUM7SUFFL0QsTUFBTSxlQUFlLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNoRCxNQUFNLEtBQUssR0FBRyxnQ0FBZ0MsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUV6RCxPQUFPLENBQ0wsTUFBQyxPQUFPLElBQUMsS0FBSyxFQUFDLFFBQVEsRUFBQyxHQUFHLEVBQUUsTUFBTSxhQUNqQyxlQUFLLE1BQU0sRUFBRSxNQUFNLEdBQUcsQ0FBQyxFQUFFLEtBQUssRUFBRSxNQUFNLEdBQUcsQ0FBQyxhQUN0QywwQkFBUSxLQUFLLEdBQVMsRUFDeEIsaUJBQ0UsTUFBTSxFQUFFLEtBQUssRUFDYixJQUFJLEVBQUMsYUFBYSxFQUNsQixXQUFXLEVBQUUsTUFBTSxFQUNuQixlQUFlLEVBQUUsbUJBQW1CLEdBQUcsR0FBRyxHQUFHLG1CQUFtQixFQUNoRSxLQUFLLEVBQUU7NEJBQ0wsZ0JBQWdCOzRCQUNoQixVQUFVLEVBQUUseUJBQXlCOzRCQUNyQyxTQUFTLEVBQUUsZ0JBQWdCOzRCQUMzQixlQUFlLEVBQUUsU0FBUzt5QkFDM0IsRUFDRCxDQUFDLEVBQUUsWUFBWSxFQUNmLEVBQUUsRUFBRSxNQUFNLEVBQ1YsRUFBRSxFQUFFLE1BQU0sR0FDVixJQUNFLEVBQ04sTUFBQyxVQUFVLElBQ1QsSUFBSSxFQUFFLENBQUMsRUFDUCxLQUFLLEVBQUUsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLEVBQ3hCLFFBQVEsRUFBRSxRQUFRLEVBQ2xCLFNBQVMsRUFBRSw4QkFBOEIsQ0FBQyxRQUFRLENBQUMsYUFFbEQsZUFBZSxTQUNMLElBQ0wsQ0FDWCxDQUFDO0FBQ0osQ0FBQztBQUVELGVBQWUsaUJBQWlCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgeyBCYXNlUHJvcHMgfSBmcm9tICcuLi8uLi90eXBlcyc7XG5pbXBvcnQgeyBtYXRjaFNpemUgfSBmcm9tICcuLi8uLi91dGlscy9tYXRjaC1zaXplJztcbmltcG9ydCBGbGV4Um93IGZyb20gJy4uL2ZsZXgtcm93L2ZsZXgtcm93JztcbmltcG9ydCBzdHlsZWQgZnJvbSAnc3R5bGVkLWNvbXBvbmVudHMnO1xuaW1wb3J0IFRleHQsIHsgVGV4dFZhcmlhdGlvbiB9IGZyb20gJy4uL3RleHQvdGV4dCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2lyY3VsYXJJbmRpY2F0b3JQcm9wcyBleHRlbmRzIEJhc2VQcm9wcyB7XG4gIHNpemU6ICdtZWRpdW0nO1xuICBwcm9ncmVzczogbnVtYmVyO1xuICB0ZXh0U2l6ZTogMSB8IDI7XG4gIHRpdGxlPzogc3RyaW5nO1xufVxuXG5leHBvcnQgZW51bSBDaXJjdWxhckluZGljYXRvclRleHRTaXplIHtcbiAgJ3NtYWxsJyA9IDEsXG4gICdkZWZhdWx0JyA9IDIsXG59XG5cbmV4cG9ydCBjb25zdCBDaXJjdWxhckluZGljYXRvclRleHRWYXJpYXRpb246IHtcbiAgW0NpcmN1bGFySW5kaWNhdG9yVGV4dFNpemUuc21hbGxdOiBUZXh0VmFyaWF0aW9uO1xuICBbQ2lyY3VsYXJJbmRpY2F0b3JUZXh0U2l6ZS5kZWZhdWx0XTogVGV4dFZhcmlhdGlvbjtcbn0gPSB7XG4gIFtDaXJjdWxhckluZGljYXRvclRleHRTaXplLnNtYWxsXTogJ2RhcmtHcmF5JyxcbiAgW0NpcmN1bGFySW5kaWNhdG9yVGV4dFNpemUuZGVmYXVsdF06ICdibGFjaycsXG59O1xuXG5jb25zdCBTdHlsZWRUZXh0ID0gc3R5bGVkKFRleHQpPHtcbiAgICBzaXplOiAxIHwgMiB8IDM7XG4gICAgc2NhbGU/OiAneHMnIHwgJ3NtJyB8ICdtZCcgfCAnbGcnO1xuICAgIGxpbmVIZWlnaHQ/OiAneHMnIHwgJ3NtJztcbiAgICB0ZXh0U2l6ZTogMSB8IDJcbn0+KFxuICAoeyB0aGVtZSwgc2l6ZSA9IDMsIHRleHRTaXplIH0pID0+ICh7XG4gICAgZm9udFdlaWdodDogbWF0Y2hTaXplKFxuICAgICAge1xuICAgICAgICAxOiB0aGVtZS50eXBvZ3JhcGh5LmZvbnRXZWlnaHQuc2VtaUJvbGQsXG4gICAgICAgIDI6IHRoZW1lLnR5cG9ncmFwaHkuZm9udFdlaWdodC5tZWRpdW0sXG4gICAgICAgIDM6IHRoZW1lLnR5cG9ncmFwaHkuZm9udFdlaWdodC5yZWd1bGFyLFxuICAgICAgfSxcbiAgICAgIHNpemVcbiAgICApLFxuICAgIGZvbnRTaXplOiBtYXRjaFNpemUoXG4gICAgICB7XG4gICAgICAgIDE6ICcwLjgxM3JlbScsXG4gICAgICAgIDI6ICcwLjg3NXJlbScsXG4gICAgICB9LFxuICAgICAgdGV4dFNpemVcbiAgICApLFxuICAgIGxpbmVIZWlnaHQ6ICcxLjI1cmVtJyxcbiAgfSlcbik7XG5cbmV4cG9ydCBjb25zdCBQcm9ncmVzc0NvbG9yc1JhbmdlID0gW1xuICB7IGlkOiAxLCBsaW1pdDogMCwgY29sb3I6ICdFNjMzMkEnIH0sXG4gIHsgaWQ6IDIsIGxpbWl0OiAwLjI1LCBjb2xvcjogJ0VEODQxNycgfSxcbiAgeyBpZDogMywgbGltaXQ6IDAuNSwgY29sb3I6ICdGMUJGMEInIH0sXG4gIHsgaWQ6IDQsIGxpbWl0OiAwLjc1LCBjb2xvcjogJ0JCREUzMScgfSxcbiAgeyBpZDogNSwgbGltaXQ6IDAuOTksIGNvbG9yOiAnODZERTU2JyB9LFxuICB7IGlkOiA2LCBsaW1pdDogMSwgY29sb3I6ICczMURFOTEnIH0sXG5dO1xuXG5jb25zdCBjYWxjdWxhdGVQZXJmb21hbmNlR3JhZGllbnRDb2xvciA9IChwcm9ncmVzcykgPT4ge1xuICBjb25zdCBQUk9HUkVTU19NSU5JTVVNID0gOTU7XG4gIGNvbnN0IFBST0dSRVNTX01BWElNVU0gPSAxMDA7XG5cbiAgaWYgKHByb2dyZXNzIDwgUFJPR1JFU1NfTUlOSU1VTSkge1xuICAgIHJldHVybiBgIyR7UHJvZ3Jlc3NDb2xvcnNSYW5nZVswXS5jb2xvcn1gO1xuICB9XG5cbiAgY29uc3QgcmF0aW8gPVxuICAgIChwcm9ncmVzcyAtIFBST0dSRVNTX01JTklNVU0pIC8gKFBST0dSRVNTX01BWElNVU0gLSBQUk9HUkVTU19NSU5JTVVNKTtcblxuICBjb25zdCBmaXJzdEdyYWRpZW50SXRlbSA9IFByb2dyZXNzQ29sb3JzUmFuZ2UuZmluZChcbiAgICAocmFuZ2UpID0+IHJhdGlvIDw9IHJhbmdlLmxpbWl0XG4gICk7XG5cbiAgY29uc3QgZmlyc3RHcmFkaWVudENvbG9yID0gZmlyc3RHcmFkaWVudEl0ZW0hLmNvbG9yO1xuXG4gIGlmIChmaXJzdEdyYWRpZW50SXRlbSEuaWQgPT09IFByb2dyZXNzQ29sb3JzUmFuZ2UubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGAjJHtmaXJzdEdyYWRpZW50Q29sb3J9YDtcbiAgfVxuXG4gIGNvbnN0IHNlY29uZEdyYWRpZW50Q29sb3IgPSBQcm9ncmVzc0NvbG9yc1JhbmdlLmZpbmQoXG4gICAgKHJhbmdlKSA9PiByYW5nZS5pZCA9PT0gZmlyc3RHcmFkaWVudEl0ZW0hLmlkICsgMVxuICApIS5jb2xvcjtcblxuICBjb25zdCBoZXggPSAoeCkgPT4ge1xuICAgIHJldHVybiB4LnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpO1xuICB9O1xuXG4gIGNvbnN0IHIgPSBNYXRoLmNlaWwoXG4gICAgcGFyc2VJbnQoZmlyc3RHcmFkaWVudENvbG9yLnN1YnN0cmluZygwLCAyKSwgMTYpICogcmF0aW8gK1xuICAgICAgcGFyc2VJbnQoc2Vjb25kR3JhZGllbnRDb2xvci5zdWJzdHJpbmcoMCwgMiksIDE2KSAqICgxIC0gcmF0aW8pXG4gICk7XG4gIGNvbnN0IGcgPSBNYXRoLmNlaWwoXG4gICAgcGFyc2VJbnQoZmlyc3RHcmFkaWVudENvbG9yLnN1YnN0cmluZygyLCA0KSwgMTYpICogcmF0aW8gK1xuICAgICAgcGFyc2VJbnQoc2Vjb25kR3JhZGllbnRDb2xvci5zdWJzdHJpbmcoMiwgNCksIDE2KSAqICgxIC0gcmF0aW8pXG4gICk7XG4gIGNvbnN0IGIgPSBNYXRoLmNlaWwoXG4gICAgcGFyc2VJbnQoZmlyc3RHcmFkaWVudENvbG9yLnN1YnN0cmluZyg0LCA2KSwgMTYpICogcmF0aW8gK1xuICAgICAgcGFyc2VJbnQoc2Vjb25kR3JhZGllbnRDb2xvci5zdWJzdHJpbmcoNCwgNiksIDE2KSAqICgxIC0gcmF0aW8pXG4gICk7XG4gIGNvbnN0IGNvbG9yID0gaGV4KHIpICsgaGV4KGcpICsgaGV4KGIpO1xuXG4gIHJldHVybiBgIyR7Y29sb3J9YDtcbn07XG5cbi8qKlxuICogQGV4YW1wbGVcbiAqIDxDaXJjdWxhckluZGljYXRvciBzaXplPVwibWVkaXVtXCIgcHJvZ3Jlc3M9ezAgLSAxMDB9IC8+XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBDaXJjdWxhckluZGljYXRvcih7XG4gIHNpemUsXG4gIHByb2dyZXNzLFxuICB0ZXh0U2l6ZSxcbiAgdGl0bGVcbn06IENpcmN1bGFySW5kaWNhdG9yUHJvcHMpIHtcbiAgY29uc3QgeyBzdHJva2UsIHJhZGl1cyB9ID0gbWF0Y2hTaXplKFxuICAgIHtcbiAgICAgIG1lZGl1bTogeyBzdHJva2U6IDQsIHJhZGl1czogMTIgfSxcbiAgICB9LFxuICAgIHNpemVcbiAgKTtcblxuICAvLyB2YWxpZGF0aW9uIDAgLSAxMDBcbiAgaWYgKHByb2dyZXNzID09IG51bGwgfHwgcHJvZ3Jlc3MgPCAwIHx8IHByb2dyZXNzID4gMTAwKSB7XG4gICAgcHJvZ3Jlc3MgPSAwO1xuICB9XG5cbiAgY29uc3Qgc3Ryb2tlUmFkaXVzID0gcmFkaXVzIC0gc3Ryb2tlIC8gMjtcbiAgY29uc3Qgc3Ryb2tlQ2lyY3VtZmVyZW5jZSA9IHN0cm9rZVJhZGl1cyAqIDIgKiBNYXRoLlBJO1xuICBjb25zdCBzdHJva2VEYXNob2Zmc2V0ID1cbiAgICBzdHJva2VDaXJjdW1mZXJlbmNlIC0gKHByb2dyZXNzIC8gMTAwKSAqIHN0cm9rZUNpcmN1bWZlcmVuY2U7XG5cbiAgY29uc3Qgcm91bmRlZFByb2dyZXNzID0gcHJvZ3Jlc3MudG9QcmVjaXNpb24oMyk7XG4gIGNvbnN0IGNvbG9yID0gY2FsY3VsYXRlUGVyZm9tYW5jZUdyYWRpZW50Q29sb3IocHJvZ3Jlc3MpO1xuXG4gIHJldHVybiAoXG4gICAgPEZsZXhSb3cgYWxpZ249XCJjZW50ZXJcIiB0YWc9e1wic3BhblwifT5cbiAgICAgIDxzdmcgaGVpZ2h0PXtyYWRpdXMgKiAyfSB3aWR0aD17cmFkaXVzICogMn0+XG4gICAgICAgICAgPHRpdGxlPnt0aXRsZX08L3RpdGxlPlxuICAgICAgICA8Y2lyY2xlXG4gICAgICAgICAgc3Ryb2tlPXtjb2xvcn1cbiAgICAgICAgICBmaWxsPVwidHJhbnNwYXJlbnRcIlxuICAgICAgICAgIHN0cm9rZVdpZHRoPXtzdHJva2V9XG4gICAgICAgICAgc3Ryb2tlRGFzaGFycmF5PXtzdHJva2VDaXJjdW1mZXJlbmNlICsgJyAnICsgc3Ryb2tlQ2lyY3VtZmVyZW5jZX1cbiAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgc3Ryb2tlRGFzaG9mZnNldCxcbiAgICAgICAgICAgIHRyYW5zaXRpb246ICdzdHJva2UtZGFzaG9mZnNldCAwLjM1cycsXG4gICAgICAgICAgICB0cmFuc2Zvcm06ICdyb3RhdGUoLTkwZGVnKScsXG4gICAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW46ICc1MCUgNTAlJyxcbiAgICAgICAgICB9fVxuICAgICAgICAgIHI9e3N0cm9rZVJhZGl1c31cbiAgICAgICAgICBjeD17cmFkaXVzfVxuICAgICAgICAgIGN5PXtyYWRpdXN9XG4gICAgICAgIC8+XG4gICAgICA8L3N2Zz5cbiAgICAgIDxTdHlsZWRUZXh0XG4gICAgICAgIHNpemU9ezN9XG4gICAgICAgIHN0eWxlPXt7IG1hcmdpbkxlZnQ6IDggfX1cbiAgICAgICAgdGV4dFNpemU9e3RleHRTaXplfVxuICAgICAgICB2YXJpYXRpb249e0NpcmN1bGFySW5kaWNhdG9yVGV4dFZhcmlhdGlvblt0ZXh0U2l6ZV19XG4gICAgICA+XG4gICAgICAgIHtyb3VuZGVkUHJvZ3Jlc3N9JVxuICAgICAgPC9TdHlsZWRUZXh0PlxuICAgIDwvRmxleFJvdz5cbiAgKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2lyY3VsYXJJbmRpY2F0b3I7XG4iXX0=