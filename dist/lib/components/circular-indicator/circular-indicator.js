var _a;
import { __assign } from "tslib";
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { matchSize } from '../../utils/match-size';
import FlexRow from '../flex-row/flex-row';
import styled from 'styled-components';
import Text from '../text/text';
export var CircularIndicatorTextSize;
(function (CircularIndicatorTextSize) {
    CircularIndicatorTextSize[CircularIndicatorTextSize["small"] = 1] = "small";
    CircularIndicatorTextSize[CircularIndicatorTextSize["default"] = 2] = "default";
})(CircularIndicatorTextSize || (CircularIndicatorTextSize = {}));
export var CircularIndicatorTextVariation = (_a = {},
    _a[CircularIndicatorTextSize.small] = 'darkGray',
    _a[CircularIndicatorTextSize.default] = 'black',
    _a);
var StyledText = styled(Text)(function (_a) {
    var theme = _a.theme, _b = _a.size, size = _b === void 0 ? 3 : _b, textSize = _a.textSize;
    return ({
        fontWeight: matchSize({
            1: theme.typography.fontWeight.semiBold,
            2: theme.typography.fontWeight.medium,
            3: theme.typography.fontWeight.regular,
        }, size),
        fontSize: matchSize({
            1: '1.3rem',
            2: '1.4rem',
        }, textSize),
        lineHeight: '2rem',
    });
});
export var ProgressColorsRange = [
    { id: 1, limit: 0, color: 'E6332A' },
    { id: 2, limit: 0.25, color: 'ED8417' },
    { id: 3, limit: 0.5, color: 'F1BF0B' },
    { id: 4, limit: 0.75, color: 'BBDE31' },
    { id: 5, limit: 0.99, color: '86DE56' },
    { id: 6, limit: 1, color: '31DE91' },
];
var calculatePerfomanceGradientColor = function (progress) {
    var PROGRESS_MINIMUM = 95;
    var PROGRESS_MAXIMUM = 100;
    if (progress < PROGRESS_MINIMUM) {
        return "#".concat(ProgressColorsRange[0].color);
    }
    var ratio = (progress - PROGRESS_MINIMUM) / (PROGRESS_MAXIMUM - PROGRESS_MINIMUM);
    var firstGradientItem = ProgressColorsRange.find(function (range) { return ratio <= range.limit; });
    var firstGradientColor = firstGradientItem.color;
    if (firstGradientItem.id === ProgressColorsRange.length) {
        return "#".concat(firstGradientColor);
    }
    var secondGradientColor = ProgressColorsRange.find(function (range) { return range.id === firstGradientItem.id + 1; }).color;
    var hex = function (x) {
        return x.toString(16).padStart(2, '0');
    };
    var r = Math.ceil(parseInt(firstGradientColor.substring(0, 2), 16) * ratio +
        parseInt(secondGradientColor.substring(0, 2), 16) * (1 - ratio));
    var g = Math.ceil(parseInt(firstGradientColor.substring(2, 4), 16) * ratio +
        parseInt(secondGradientColor.substring(2, 4), 16) * (1 - ratio));
    var b = Math.ceil(parseInt(firstGradientColor.substring(4, 6), 16) * ratio +
        parseInt(secondGradientColor.substring(4, 6), 16) * (1 - ratio));
    var color = hex(r) + hex(g) + hex(b);
    return "#".concat(color);
};
/**
 * @example
 * <CircularIndicator size="medium" progress={0 - 100} />
 */
export function CircularIndicator(_a) {
    var size = _a.size, progress = _a.progress, textSize = _a.textSize;
    var _b = matchSize({
        medium: { stroke: 4, radius: 12 },
    }, size), stroke = _b.stroke, radius = _b.radius;
    // validation 0 - 100
    if (progress == null || progress < 0 || progress > 100) {
        progress = 0;
    }
    var strokeRadius = radius - stroke / 2;
    var strokeCircumference = strokeRadius * 2 * Math.PI;
    var strokeDashoffset = strokeCircumference - (progress / 100) * strokeCircumference;
    var roundedProgress = progress.toPrecision(3);
    var color = calculatePerfomanceGradientColor(progress);
    return (_jsxs(FlexRow, __assign({ align: "center" }, { children: [_jsx("svg", __assign({ height: radius * 2, width: radius * 2 }, { children: _jsx("circle", { stroke: color, fill: "transparent", strokeWidth: stroke, strokeDasharray: strokeCircumference + ' ' + strokeCircumference, style: {
                        strokeDashoffset: strokeDashoffset,
                        transition: 'stroke-dashoffset 0.35s',
                        transform: 'rotate(-90deg)',
                        transformOrigin: '50% 50%',
                    }, r: strokeRadius, cx: radius, cy: radius }) })), _jsxs(StyledText, __assign({ size: 3, style: { marginLeft: 8 }, textSize: textSize, variation: CircularIndicatorTextVariation[textSize] }, { children: [roundedProgress, "%"] }))] })));
}
export default CircularIndicator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2lyY3VsYXItaW5kaWNhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9jb21wb25lbnRzL2NpcmN1bGFyLWluZGljYXRvci9jaXJjdWxhci1pbmRpY2F0b3IudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUdBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNuRCxPQUFPLE9BQU8sTUFBTSxzQkFBc0IsQ0FBQztBQUUzQyxPQUFPLE1BQU0sTUFBTSxtQkFBbUIsQ0FBQztBQUN2QyxPQUFPLElBQXVCLE1BQU0sY0FBYyxDQUFDO0FBUW5ELE1BQU0sQ0FBTixJQUFZLHlCQUdYO0FBSEQsV0FBWSx5QkFBeUI7SUFDbkMsMkVBQVcsQ0FBQTtJQUNYLCtFQUFhLENBQUE7QUFDZixDQUFDLEVBSFcseUJBQXlCLEtBQXpCLHlCQUF5QixRQUdwQztBQUVELE1BQU0sQ0FBQyxJQUFNLDhCQUE4QjtJQUl6QyxHQUFDLHlCQUF5QixDQUFDLEtBQUssSUFBRyxVQUFVO0lBQzdDLEdBQUMseUJBQXlCLENBQUMsT0FBTyxJQUFHLE9BQU87T0FDN0MsQ0FBQztBQUVGLElBQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FDN0IsVUFBQyxFQUE2QjtRQUEzQixLQUFLLFdBQUEsRUFBRSxZQUFRLEVBQVIsSUFBSSxtQkFBRyxDQUFDLEtBQUEsRUFBRSxRQUFRLGNBQUE7SUFBTyxPQUFBLENBQUM7UUFDbEMsVUFBVSxFQUFFLFNBQVMsQ0FDbkI7WUFDRSxDQUFDLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsUUFBUTtZQUN2QyxDQUFDLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsTUFBTTtZQUNyQyxDQUFDLEVBQUUsS0FBSyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsT0FBTztTQUN2QyxFQUNELElBQUksQ0FDTDtRQUNELFFBQVEsRUFBRSxT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dkQsSUFBTSxnQkFBZ0IsR0FDcEIsbUJBQW1CLEdBQUcsQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLEdBQUcsbUJBQW1CLENBQUM7SUFFL0QsSUFBTSxlQUFlLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNoRCxJQUFNLEtBQUssR0FBRyxnQ0FBZ0MsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUV6RCxPQUFPLENBQ0wsTUFBQyxPQUFPLGFBQUMsS0FBSyxFQUFDLFFBQVEsaUJBQ3JCLHVCQUFLLE1BQU0sRUFBRSxNQUFNLEdBQUcsQ0FBQyxFQUFFLEtBQUssRUFBRSxNQUFNLEdBQUcsQ0FBQyxnQkFDeEMsaUJBQ0UsTUFBTSxFQUFFLEtBQUssRUFDYixJQUFJLEVBQUMsYUFBYSxFQUNsQixXQUFXLEVBQUUsTUFBTSxFQUNuQixlQUFlLEVBQUUsbUJBQW1CLEdBQUcsR0FBRyxHQUFHLG1CQUFtQixFQUNoRSxLQUFLLEVBQUU7d0JBQ0wsZ0JBQWdCLGtCQUFBO3dCQUNoQixVQUFVLEVBQUUseUJBQXlCO3dCQUNyQyxTQUFTLEVBQUUsZ0JBQWdCO3dCQUMzQixlQUFlLEVBQUUsU0FBUztxQkFDM0IsRUFDRCxDQUFDLEVBQUUsWUFBWSxFQUNmLEVBQUUsRUFBRSxNQUFNLEVBQ1YsRUFBRSxFQUFFLE1BQU0sR0FDVixJQUNFLEVBQ04sTUFBQyxVQUFVLGFBQ1QsSUFBSSxFQUFFLENBQUMsRUFDUCxLQUFLLEVBQUUsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLEVBQ3hCLFFBQVEsRUFBRSxRQUFRLEVBQ2xCLFNBQVMsRUFBRSw4QkFBOEIsQ0FBQyxRQUFRLENBQUMsaUJBRWxELGVBQWUsVUFDTCxLQUNMLENBQ1gsQ0FBQztBQUNKLENBQUM7QUFFRCxlQUFlLGlCQUFpQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcclxuXHJcbmltcG9ydCB7IEJhc2VQcm9wcyB9IGZyb20gJy4uLy4uL3R5cGVzJztcclxuaW1wb3J0IHsgbWF0Y2hTaXplIH0gZnJvbSAnLi4vLi4vdXRpbHMvbWF0Y2gtc2l6ZSc7XHJcbmltcG9ydCBGbGV4Um93IGZyb20gJy4uL2ZsZXgtcm93L2ZsZXgtcm93JztcclxuaW1wb3J0IHsgQm9keVRleHRQcm9wcyB9IGZyb20gJy4uL2JvZHktdGV4dC9ib2R5LXRleHQnO1xyXG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcclxuaW1wb3J0IFRleHQsIHsgVGV4dFZhcmlhdGlvbiB9IGZyb20gJy4uL3RleHQvdGV4dCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENpcmN1bGFySW5kaWNhdG9yUHJvcHMgZXh0ZW5kcyBCYXNlUHJvcHMge1xyXG4gIHNpemU6ICdtZWRpdW0nO1xyXG4gIHByb2dyZXNzOiBudW1iZXI7XHJcbiAgdGV4dFNpemU6IDEgfCAyO1xyXG59XHJcblxyXG5leHBvcnQgZW51bSBDaXJjdWxhckluZGljYXRvclRleHRTaXplIHtcclxuICAnc21hbGwnID0gMSxcclxuICAnZGVmYXVsdCcgPSAyLFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgQ2lyY3VsYXJJbmRpY2F0b3JUZXh0VmFyaWF0aW9uOiB7XHJcbiAgW0NpcmN1bGFySW5kaWNhdG9yVGV4dFNpemUuc21hbGxdOiBUZXh0VmFyaWF0aW9uO1xyXG4gIFtDaXJjdWxhckluZGljYXRvclRleHRTaXplLmRlZmF1bHRdOiBUZXh0VmFyaWF0aW9uO1xyXG59ID0ge1xyXG4gIFtDaXJjdWxhckluZGljYXRvclRleHRTaXplLnNtYWxsXTogJ2RhcmtHcmF5JyxcclxuICBbQ2lyY3VsYXJJbmRpY2F0b3JUZXh0U2l6ZS5kZWZhdWx0XTogJ2JsYWNrJyxcclxufTtcclxuXHJcbmNvbnN0IFN0eWxlZFRleHQgPSBzdHlsZWQoVGV4dCk8Qm9keVRleHRQcm9wcyAmIHsgdGV4dFNpemU6IDEgfCAyIH0+KFxyXG4gICh7IHRoZW1lLCBzaXplID0gMywgdGV4dFNpemUgfSkgPT4gKHtcclxuICAgIGZvbnRXZWlnaHQ6IG1hdGNoU2l6ZShcclxuICAgICAge1xyXG4gICAgICAgIDE6IHRoZW1lLnR5cG9ncmFwaHkuZm9udFdlaWdodC5zZW1pQm9sZCxcclxuICAgICAgICAyOiB0aGVtZS50eXBvZ3JhcGh5LmZvbnRXZWlnaHQubWVkaXVtLFxyXG4gICAgICAgIDM6IHRoZW1lLnR5cG9ncmFwaHkuZm9udFdlaWdodC5yZWd1bGFyLFxyXG4gICAgICB9LFxyXG4gICAgICBzaXplXHJcbiAgICApLFxyXG4gICAgZm9udFNpemU6IG1hdGNoU2l6ZShcclxuICAgICAge1xyXG4gICAgICAgIDE6ICcxLjNyZW0nLFxyXG4gICAgICAgIDI6ICcxLjRyZW0nLFxyXG4gICAgICB9LFxyXG4gICAgICB0ZXh0U2l6ZVxyXG4gICAgKSxcclxuICAgIGxpbmVIZWlnaHQ6ICcycmVtJyxcclxuICB9KVxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IFByb2dyZXNzQ29sb3JzUmFuZ2UgPSBbXHJcbiAgeyBpZDogMSwgbGltaXQ6IDAsIGNvbG9yOiAnRTYzMzJBJyB9LFxyXG4gIHsgaWQ6IDIsIGxpbWl0OiAwLjI1LCBjb2xvcjogJ0VEODQxNycgfSxcclxuICB7IGlkOiAzLCBsaW1pdDogMC41LCBjb2xvcjogJ0YxQkYwQicgfSxcclxuICB7IGlkOiA0LCBsaW1pdDogMC43NSwgY29sb3I6ICdCQkRFMzEnIH0sXHJcbiAgeyBpZDogNSwgbGltaXQ6IDAuOTksIGNvbG9yOiAnODZERTU2JyB9LFxyXG4gIHsgaWQ6IDYsIGxpbWl0OiAxLCBjb2xvcjogJzMxREU5MScgfSxcclxuXTtcclxuXHJcbmNvbnN0IGNhbGN1bGF0ZVBlcmZvbWFuY2VHcmFkaWVudENvbG9yID0gKHByb2dyZXNzKSA9PiB7XHJcbiAgY29uc3QgUFJPR1JFU1NfTUlOSU1VTSA9IDk1O1xyXG4gIGNvbnN0IFBST0dSRVNTX01BWElNVU0gPSAxMDA7XHJcblxyXG4gIGlmIChwcm9ncmVzcyA8IFBST0dSRVNTX01JTklNVU0pIHtcclxuICAgIHJldHVybiBgIyR7UHJvZ3Jlc3NDb2xvcnNSYW5nZVswXS5jb2xvcn1gO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcmF0aW8gPVxyXG4gICAgKHByb2dyZXNzIC0gUFJPR1JFU1NfTUlOSU1VTSkgLyAoUFJPR1JFU1NfTUFYSU1VTSAtIFBST0dSRVNTX01JTklNVU0pO1xyXG5cclxuICBjb25zdCBmaXJzdEdyYWRpZW50SXRlbSA9IFByb2dyZXNzQ29sb3JzUmFuZ2UuZmluZChcclxuICAgIChyYW5nZSkgPT4gcmF0aW8gPD0gcmFuZ2UubGltaXRcclxuICApO1xyXG5cclxuICBjb25zdCBmaXJzdEdyYWRpZW50Q29sb3IgPSBmaXJzdEdyYWRpZW50SXRlbSEuY29sb3I7XHJcblxyXG4gIGlmIChmaXJzdEdyYWRpZW50SXRlbSEuaWQgPT09IFByb2dyZXNzQ29sb3JzUmFuZ2UubGVuZ3RoKSB7XHJcbiAgICByZXR1cm4gYCMke2ZpcnN0R3JhZGllbnRDb2xvcn1gO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2Vjb25kR3JhZGllbnRDb2xvciA9IFByb2dyZXNzQ29sb3JzUmFuZ2UuZmluZChcclxuICAgIChyYW5nZSkgPT4gcmFuZ2UuaWQgPT09IGZpcnN0R3JhZGllbnRJdGVtIS5pZCArIDFcclxuICApIS5jb2xvcjtcclxuXHJcbiAgY29uc3QgaGV4ID0gKHgpID0+IHtcclxuICAgIHJldHVybiB4LnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IHIgPSBNYXRoLmNlaWwoXHJcbiAgICBwYXJzZUludChmaXJzdEdyYWRpZW50Q29sb3Iuc3Vic3RyaW5nKDAsIDIpLCAxNikgKiByYXRpbyArXHJcbiAgICAgIHBhcnNlSW50KHNlY29uZEdyYWRpZW50Q29sb3Iuc3Vic3RyaW5nKDAsIDIpLCAxNikgKiAoMSAtIHJhdGlvKVxyXG4gICk7XHJcbiAgY29uc3QgZyA9IE1hdGguY2VpbChcclxuICAgIHBhcnNlSW50KGZpcnN0R3JhZGllbnRDb2xvci5zdWJzdHJpbmcoMiwgNCksIDE2KSAqIHJhdGlvICtcclxuICAgICAgcGFyc2VJbnQoc2Vjb25kR3JhZGllbnRDb2xvci5zdWJzdHJpbmcoMiwgNCksIDE2KSAqICgxIC0gcmF0aW8pXHJcbiAgKTtcclxuICBjb25zdCBiID0gTWF0aC5jZWlsKFxyXG4gICAgcGFyc2VJbnQoZmlyc3RHcmFkaWVudENvbG9yLnN1YnN0cmluZyg0LCA2KSwgMTYpICogcmF0aW8gK1xyXG4gICAgICBwYXJzZUludChzZWNvbmRHcmFkaWVudENvbG9yLnN1YnN0cmluZyg0LCA2KSwgMTYpICogKDEgLSByYXRpbylcclxuICApO1xyXG4gIGNvbnN0IGNvbG9yID0gaGV4KHIpICsgaGV4KGcpICsgaGV4KGIpO1xyXG5cclxuICByZXR1cm4gYCMke2NvbG9yfWA7XHJcbn07XHJcblxyXG4vKipcclxuICogQGV4YW1wbGVcclxuICogPENpcmN1bGFySW5kaWNhdG9yIHNpemU9XCJtZWRpdW1cIiBwcm9ncmVzcz17MCAtIDEwMH0gLz5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBDaXJjdWxhckluZGljYXRvcih7XHJcbiAgc2l6ZSxcclxuICBwcm9ncmVzcyxcclxuICB0ZXh0U2l6ZSxcclxufTogQ2lyY3VsYXJJbmRpY2F0b3JQcm9wcykge1xyXG4gIGNvbnN0IHsgc3Ryb2tlLCByYWRpdXMgfSA9IG1hdGNoU2l6ZShcclxuICAgIHtcclxuICAgICAgbWVkaXVtOiB7IHN0cm9rZTogNCwgcmFkaXVzOiAxMiB9LFxyXG4gICAgfSxcclxuICAgIHNpemVcclxuICApO1xyXG5cclxuICAvLyB2YWxpZGF0aW9uIDAgLSAxMDBcclxuICBpZiAocHJvZ3Jlc3MgPT0gbnVsbCB8fCBwcm9ncmVzcyA8IDAgfHwgcHJvZ3Jlc3MgPiAxMDApIHtcclxuICAgIHByb2dyZXNzID0gMDtcclxuICB9XHJcblxyXG4gIGNvbnN0IHN0cm9rZVJhZGl1cyA9IHJhZGl1cyAtIHN0cm9rZSAvIDI7XHJcbiAgY29uc3Qgc3Ryb2tlQ2lyY3VtZmVyZW5jZSA9IHN0cm9rZVJhZGl1cyAqIDIgKiBNYXRoLlBJO1xyXG4gIGNvbnN0IHN0cm9rZURhc2hvZmZzZXQgPVxyXG4gICAgc3Ryb2tlQ2lyY3VtZmVyZW5jZSAtIChwcm9ncmVzcyAvIDEwMCkgKiBzdHJva2VDaXJjdW1mZXJlbmNlO1xyXG5cclxuICBjb25zdCByb3VuZGVkUHJvZ3Jlc3MgPSBwcm9ncmVzcy50b1ByZWNpc2lvbigzKTtcclxuICBjb25zdCBjb2xvciA9IGNhbGN1bGF0ZVBlcmZvbWFuY2VHcmFkaWVudENvbG9yKHByb2dyZXNzKTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxGbGV4Um93IGFsaWduPVwiY2VudGVyXCI+XHJcbiAgICAgIDxzdmcgaGVpZ2h0PXtyYWRpdXMgKiAyfSB3aWR0aD17cmFkaXVzICogMn0+XHJcbiAgICAgICAgPGNpcmNsZVxyXG4gICAgICAgICAgc3Ryb2tlPXtjb2xvcn1cclxuICAgICAgICAgIGZpbGw9XCJ0cmFuc3BhcmVudFwiXHJcbiAgICAgICAgICBzdHJva2VXaWR0aD17c3Ryb2tlfVxyXG4gICAgICAgICAgc3Ryb2tlRGFzaGFycmF5PXtzdHJva2VDaXJjdW1mZXJlbmNlICsgJyAnICsgc3Ryb2tlQ2lyY3VtZmVyZW5jZX1cclxuICAgICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICAgIHN0cm9rZURhc2hvZmZzZXQsXHJcbiAgICAgICAgICAgIHRyYW5zaXRpb246ICdzdHJva2UtZGFzaG9mZnNldCAwLjM1cycsXHJcbiAgICAgICAgICAgIHRyYW5zZm9ybTogJ3JvdGF0ZSgtOTBkZWcpJyxcclxuICAgICAgICAgICAgdHJhbnNmb3JtT3JpZ2luOiAnNTAlIDUwJScsXHJcbiAgICAgICAgICB9fVxyXG4gICAgICAgICAgcj17c3Ryb2tlUmFkaXVzfVxyXG4gICAgICAgICAgY3g9e3JhZGl1c31cclxuICAgICAgICAgIGN5PXtyYWRpdXN9XHJcbiAgICAgICAgLz5cclxuICAgICAgPC9zdmc+XHJcbiAgICAgIDxTdHlsZWRUZXh0XHJcbiAgICAgICAgc2l6ZT17M31cclxuICAgICAgICBzdHlsZT17eyBtYXJnaW5MZWZ0OiA4IH19XHJcbiAgICAgICAgdGV4dFNpemU9e3RleHRTaXplfVxyXG4gICAgICAgIHZhcmlhdGlvbj17Q2lyY3VsYXJJbmRpY2F0b3JUZXh0VmFyaWF0aW9uW3RleHRTaXplXX1cclxuICAgICAgPlxyXG4gICAgICAgIHtyb3VuZGVkUHJvZ3Jlc3N9JVxyXG4gICAgICA8L1N0eWxlZFRleHQ+XHJcbiAgICA8L0ZsZXhSb3c+XHJcbiAgKTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2lyY3VsYXJJbmRpY2F0b3I7XHJcbiJdfQ==