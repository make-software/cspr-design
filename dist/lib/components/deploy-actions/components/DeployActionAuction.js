import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { AuctionManagerEntryPoint } from 'casper-js-sdk';
import { deriveAccountInfo } from '../../../utils/account.tsx';
import { useMatchMedia } from '../../../utils/match-media';
import DeployFiatAmount from './DeployFiatAmount';
import { useDeployActionDataContext } from '../services/deploy-action-context';
import { AuctionContractIcon } from '../../../icons-index';
import FlexRow from '../../flex-row/flex-row';
import Avatar from '../../avatar/avatar';
import BodyText from '../../body-text/body-text';
import Link from '../../link/link';
import Address from '../../address/address';
const auctionActionNameMap = {
    [AuctionManagerEntryPoint.add]: 'Add',
    [AuctionManagerEntryPoint.withdraw]: 'Withdraw',
    [AuctionManagerEntryPoint.activate]: 'Activate',
    [AuctionManagerEntryPoint.delegate]: 'Delegate',
    [AuctionManagerEntryPoint.undelegate]: 'Undelegate',
    [AuctionManagerEntryPoint.redelegate]: 'Redelegate',
};
const AuctionContractIdentifier = ({ identifier, contract_package_hash, }) => {
    const { csprLiveDomainPath } = useDeployActionDataContext();
    return (_jsxs(FlexRow, { align: "center", itemsSpacing: 8, children: [_jsx(Avatar, { path: AuctionContractIcon, size: 'small', alt: 'Auction contract logo' }), _jsx(BodyText, { size: 3, variation: "blue", monotype: true, children: _jsx(Link, { href: `${csprLiveDomainPath}/contract-package/${contract_package_hash}`, ariaDescription: 'Link to contract package details', color: 'primaryBlue', children: identifier }) })] }));
};
const ValidatorAccountInfo = ({ publicKey, prefix }) => {
    const { getAccountInfo, csprLiveDomainPath } = useDeployActionDataContext();
    const avatarSize = useMatchMedia(['small', 'default'], []);
    const accountInfo = getAccountInfo(publicKey);
    const validatorLogo = deriveAccountInfo(accountInfo?.account_info || accountInfo?.centralized_account_info);
    const validatorName = accountInfo?.account_info?.info?.owner?.name;
    return publicKey ? (_jsxs(_Fragment, { children: [_jsx(BodyText, { size: 3, variation: "darkGray", children: prefix }), _jsx(Address, { logo: validatorLogo && validatorLogo?.logo, name: validatorName, hash: publicKey, loading: !publicKey, navigateToPath: `${csprLiveDomainPath}/account/${publicKey}`, avatarSize: avatarSize, hashFontSize: 'sm', minifiedCopyNotification: true })] })) : null;
};
const DefaultAuctionAction = ({ deploy }) => (_jsxs(FlexRow, { align: 'center', itemsSpacing: 8, children: [_jsx(BodyText, { size: 3, monotype: true, variation: 'black', children: deploy.entryPoint?.name }), _jsx(BodyText, { size: 3, variation: "darkGray", children: "with" }), _jsx(AuctionContractIdentifier, { identifier: 'Auction System Contract', contract_package_hash: deploy.contractPackage?.contract_package_hash })] }));
const ManageAuctionBidAction = ({ deploy }) => {
    const { args, timeTransactionCurrencyRate, contractPackage, entryPoint } = deploy;
    const amount = args.amount?.parsed;
    return (_jsxs(FlexRow, { align: 'center', itemsSpacing: 8, children: [_jsx(BodyText, { size: 3, monotype: true, variation: 'black', children: auctionActionNameMap[entryPoint?.name || ''] }), _jsx(AuctionContractIdentifier, { identifier: 'Auction', contract_package_hash: contractPackage?.contract_package_hash }), _jsx(BodyText, { size: 3, variation: "black", monotype: true, children: "bid" }), amount && (_jsxs(_Fragment, { children: [_jsx(BodyText, { size: 3, variation: "darkGray", children: "of" }), _jsx(DeployFiatAmount, { amount: amount, rate: timeTransactionCurrencyRate })] }))] }));
};
const DelegationAuctionAction = ({ deploy }) => {
    const { timeTransactionCurrencyRate, entryPoint, args } = deploy;
    const amount = args.amount?.parsed;
    const initialValidatorPrefix = entryPoint?.name === AuctionManagerEntryPoint.delegate ? 'to' : 'from';
    return (_jsxs(FlexRow, { align: 'center', gap: 8, children: [_jsx(BodyText, { size: 3, monotype: true, variation: 'black', children: auctionActionNameMap[entryPoint?.name || ''] }), amount && (_jsx(DeployFiatAmount, { amount: amount, rate: timeTransactionCurrencyRate })), _jsx(ValidatorAccountInfo, { publicKey: args.validator?.parsed, prefix: initialValidatorPrefix }), _jsx(ValidatorAccountInfo, { publicKey: args.new_validator?.parsed, prefix: 'to' })] }));
};
const DeployActionAuction = ({ deploy }) => {
    const { entryPoint } = deploy;
    const entryPointName = entryPoint?.name || '';
    const isManageAuctionBidAction = entryPointName === AuctionManagerEntryPoint.activate ||
        entryPointName === AuctionManagerEntryPoint.withdraw ||
        entryPointName === AuctionManagerEntryPoint.add;
    const isDelegationAction = entryPointName === AuctionManagerEntryPoint.delegate ||
        entryPointName === AuctionManagerEntryPoint.undelegate ||
        entryPointName === AuctionManagerEntryPoint.redelegate;
    if (isDelegationAction) {
        return _jsx(DelegationAuctionAction, { deploy: deploy });
    }
    if (isManageAuctionBidAction) {
        return _jsx(ManageAuctionBidAction, { deploy: deploy });
    }
    return _jsx(DefaultAuctionAction, { deploy: deploy });
};
export default DeployActionAuction;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGVwbG95QWN0aW9uQXVjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9kZXBsb3ktYWN0aW9ucy9jb21wb25lbnRzL0RlcGxveUFjdGlvbkF1Y3Rpb24udHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDekQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDL0QsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQzNELE9BQU8sZ0JBQWdCLE1BQU0sb0JBQW9CLENBQUM7QUFDbEQsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDL0UsT0FBTyxFQUFDLG1CQUFtQixFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFDekQsT0FBTyxPQUFPLE1BQU0seUJBQXlCLENBQUM7QUFDOUMsT0FBTyxNQUFNLE1BQU0scUJBQXFCLENBQUM7QUFDekMsT0FBTyxRQUFRLE1BQU0sMkJBQTJCLENBQUM7QUFDakQsT0FBTyxJQUFJLE1BQU0saUJBQWlCLENBQUM7QUFFbkMsT0FBTyxPQUFPLE1BQU0sdUJBQXVCLENBQUM7QUFFNUMsTUFBTSxvQkFBb0IsR0FBRztJQUMzQixDQUFDLHdCQUF3QixDQUFDLEdBQUcsQ0FBQyxFQUFFLEtBQUs7SUFDckMsQ0FBQyx3QkFBd0IsQ0FBQyxRQUFRLENBQUMsRUFBRSxVQUFVO0lBQy9DLENBQUMsd0JBQXdCLENBQUMsUUFBUSxDQUFDLEVBQUUsVUFBVTtJQUMvQyxDQUFDLHdCQUF3QixDQUFDLFFBQVEsQ0FBQyxFQUFFLFVBQVU7SUFDL0MsQ0FBQyx3QkFBd0IsQ0FBQyxVQUFVLENBQUMsRUFBRSxZQUFZO0lBQ25ELENBQUMsd0JBQXdCLENBQUMsVUFBVSxDQUFDLEVBQUUsWUFBWTtDQUNwRCxDQUFDO0FBRUYs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LEVBQUUsQ0FBQztRQUM3QixPQUFPLEtBQUMsc0JBQXNCLElBQUMsTUFBTSxFQUFFLE1BQU0sR0FBSSxDQUFDO0lBQ3BELENBQUM7SUFFRCxPQUFPLEtBQUMsb0JBQW9CLElBQUMsTUFBTSxFQUFFLE1BQU0sR0FBSSxDQUFDO0FBQ2xELENBQUMsQ0FBQztBQUVGLGVBQWUsbUJBQW1CLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQXVjdGlvbk1hbmFnZXJFbnRyeVBvaW50IH0gZnJvbSAnY2FzcGVyLWpzLXNkayc7XG5pbXBvcnQgeyBkZXJpdmVBY2NvdW50SW5mbyB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2FjY291bnQudHN4JztcbmltcG9ydCB7IHVzZU1hdGNoTWVkaWEgfSBmcm9tICcuLi8uLi8uLi91dGlscy9tYXRjaC1tZWRpYSc7XG5pbXBvcnQgRGVwbG95RmlhdEFtb3VudCBmcm9tICcuL0RlcGxveUZpYXRBbW91bnQnO1xuaW1wb3J0IHsgdXNlRGVwbG95QWN0aW9uRGF0YUNvbnRleHQgfSBmcm9tICcuLi9zZXJ2aWNlcy9kZXBsb3ktYWN0aW9uLWNvbnRleHQnO1xuaW1wb3J0IHtBdWN0aW9uQ29udHJhY3RJY29ufSBmcm9tICcuLi8uLi8uLi9pY29ucy1pbmRleCc7XG5pbXBvcnQgRmxleFJvdyBmcm9tICcuLi8uLi9mbGV4LXJvdy9mbGV4LXJvdyc7XG5pbXBvcnQgQXZhdGFyIGZyb20gJy4uLy4uL2F2YXRhci9hdmF0YXInO1xuaW1wb3J0IEJvZHlUZXh0IGZyb20gJy4uLy4uL2JvZHktdGV4dC9ib2R5LXRleHQnO1xuaW1wb3J0IExpbmsgZnJvbSAnLi4vLi4vbGluay9saW5rJztcbmltcG9ydCB7IEFjY291bnRJbmZvUmVzdWx0LCBEZXBsb3kgfSBmcm9tICcuLi8uLi8uLi90eXBlcy90eXBlcyc7XG5pbXBvcnQgQWRkcmVzcyBmcm9tICcuLi8uLi9hZGRyZXNzL2FkZHJlc3MnO1xuXG5jb25zdCBhdWN0aW9uQWN0aW9uTmFtZU1hcCA9IHtcbiAgW0F1Y3Rpb25NYW5hZ2VyRW50cnlQb2ludC5hZGRdOiAnQWRkJyxcbiAgW0F1Y3Rpb25NYW5hZ2VyRW50cnlQb2ludC53aXRoZHJhd106ICdXaXRoZHJhdycsXG4gIFtBdWN0aW9uTWFuYWdlckVudHJ5UG9pbnQuYWN0aXZhdGVdOiAnQWN0aXZhdGUnLFxuICBbQXVjdGlvbk1hbmFnZXJFbnRyeVBvaW50LmRlbGVnYXRlXTogJ0RlbGVnYXRlJyxcbiAgW0F1Y3Rpb25NYW5hZ2VyRW50cnlQb2ludC51bmRlbGVnYXRlXTogJ1VuZGVsZWdhdGUnLFxuICBbQXVjdGlvbk1hbmFnZXJFbnRyeVBvaW50LnJlZGVsZWdhdGVdOiAnUmVkZWxlZ2F0ZScsXG59O1xuXG5jb25zdCBBdWN0aW9uQ29udHJhY3RJZGVudGlmaWVyID0gKHtcbiAgaWRlbnRpZmllcixcbiAgY29udHJhY3RfcGFja2FnZV9oYXNoLFxufToge1xuICBpZGVudGlmaWVyOiBzdHJpbmc7XG4gIGNvbnRyYWN0X3BhY2thZ2VfaGFzaDogc3RyaW5nIHwgdW5kZWZpbmVkO1xufSkgPT4ge1xuICBjb25zdCB7IGNzcHJMaXZlRG9tYWluUGF0aCB9ID0gdXNlRGVwbG95QWN0aW9uRGF0YUNvbnRleHQoKTtcbiAgcmV0dXJuIChcbiAgICA8RmxleFJvdyBhbGlnbj1cImNlbnRlclwiIGl0ZW1zU3BhY2luZz17OH0+XG4gICAgICA8QXZhdGFyXG4gICAgICAgIHBhdGg9e0F1Y3Rpb25Db250cmFjdEljb259XG4gICAgICAgIHNpemU9eydzbWFsbCd9XG4gICAgICAgIGFsdD17J0F1Y3Rpb24gY29udHJhY3QgbG9nbyd9XG4gICAgICAvPlxuICAgICAgPEJvZHlUZXh0IHNpemU9ezN9IHZhcmlhdGlvbj1cImJsdWVcIiBtb25vdHlwZT5cbiAgICAgICAgPExpbmtcbiAgICAgICAgICBocmVmPXtgJHtjc3ByTGl2ZURvbWFpblBhdGh9L2NvbnRyYWN0LXBhY2thZ2UvJHtjb250cmFjdF9wYWNrYWdlX2hhc2h9YH1cbiAgICAgICAgICBhcmlhRGVzY3JpcHRpb249eydMaW5rIHRvIGNvbnRyYWN0IHBhY2thZ2UgZGV0YWlscyd9XG4gICAgICAgICAgY29sb3I9eydwcmltYXJ5Qmx1ZSd9XG4gICAgICAgID5cbiAgICAgICAgICB7aWRlbnRpZmllcn1cbiAgICAgICAgPC9MaW5rPlxuICAgICAgPC9Cb2R5VGV4dD5cbiAgICA8L0ZsZXhSb3c+XG4gICk7XG59O1xuXG5jb25zdCBWYWxpZGF0b3JBY2NvdW50SW5mbyA9ICh7IHB1YmxpY0tleSwgcHJlZml4IH0pID0+IHtcbiAgY29uc3QgeyBnZXRBY2NvdW50SW5mbywgY3NwckxpdmVEb21haW5QYXRoIH0gPSB1c2VEZXBsb3lBY3Rpb25EYXRhQ29udGV4dCgpO1xuICBjb25zdCBhdmF0YXJTaXplID0gdXNlTWF0Y2hNZWRpYShbJ3NtYWxsJywgJ2RlZmF1bHQnXSwgW10pO1xuXG4gIGNvbnN0IGFjY291bnRJbmZvID0gZ2V0QWNjb3VudEluZm88QWNjb3VudEluZm9SZXN1bHQ+KHB1YmxpY0tleSk7XG4gIGNvbnN0IHZhbGlkYXRvckxvZ28gPSBkZXJpdmVBY2NvdW50SW5mbyhcbiAgICBhY2NvdW50SW5mbz8uYWNjb3VudF9pbmZvIHx8IGFjY291bnRJbmZvPy5jZW50cmFsaXplZF9hY2NvdW50X2luZm8sXG4gICk7XG4gIGNvbnN0IHZhbGlkYXRvck5hbWUgPSBhY2NvdW50SW5mbz8uYWNjb3VudF9pbmZvPy5pbmZvPy5vd25lcj8ubmFtZTtcblxuICByZXR1cm4gcHVibGljS2V5ID8gKFxuICAgIDw+XG4gICAgICA8Qm9keVRleHQgc2l6ZT17M30gdmFyaWF0aW9uPVwiZGFya0dyYXlcIj5cbiAgICAgICAge3ByZWZpeH1cbiAgICAgIDwvQm9keVRleHQ+XG4gICAgICA8QWRkcmVzc1xuICAgICAgICBsb2dvPXt2YWxpZGF0b3JMb2dvICYmIHZhbGlkYXRvckxvZ28/LmxvZ299XG4gICAgICAgIG5hbWU9e3ZhbGlkYXRvck5hbWV9XG4gICAgICAgIGhhc2g9e3B1YmxpY0tleX1cbiAgICAgICAgbG9hZGluZz17IXB1YmxpY0tleX1cbiAgICAgICAgbmF2aWdhdGVUb1BhdGg9e2Ake2NzcHJMaXZlRG9tYWluUGF0aH0vYWNjb3VudC8ke3B1YmxpY0tleX1gfVxuICAgICAgICBhdmF0YXJTaXplPXthdmF0YXJTaXplfVxuICAgICAgICBoYXNoRm9udFNpemU9eydzbSd9XG4gICAgICAgIG1pbmlmaWVkQ29weU5vdGlmaWNhdGlvblxuICAgICAgLz5cbiAgICA8Lz5cbiAgKSA6IG51bGw7XG59O1xuXG5jb25zdCBEZWZhdWx0QXVjdGlvbkFjdGlvbiA9ICh7IGRlcGxveSB9OiB7IGRlcGxveTogRGVwbG95IH0pID0+IChcbiAgPEZsZXhSb3cgYWxpZ249eydjZW50ZXInfSBpdGVtc1NwYWNpbmc9ezh9PlxuICAgIDxCb2R5VGV4dCBzaXplPXszfSBtb25vdHlwZSB2YXJpYXRpb249eydibGFjayd9PlxuICAgICAge2RlcGxveS5lbnRyeVBvaW50Py5uYW1lfVxuICAgIDwvQm9keVRleHQ+XG4gICAgPEJvZHlUZXh0IHNpemU9ezN9IHZhcmlhdGlvbj1cImRhcmtHcmF5XCI+XG4gICAgICB3aXRoXG4gICAgPC9Cb2R5VGV4dD5cbiAgICA8QXVjdGlvbkNvbnRyYWN0SWRlbnRpZmllclxuICAgICAgaWRlbnRpZmllcj17J0F1Y3Rpb24gU3lzdGVtIENvbnRyYWN0J31cbiAgICAgIGNvbnRyYWN0X3BhY2thZ2VfaGFzaD17ZGVwbG95LmNvbnRyYWN0UGFja2FnZT8uY29udHJhY3RfcGFja2FnZV9oYXNofVxuICAgIC8+XG4gIDwvRmxleFJvdz5cbik7XG5cbmNvbnN0IE1hbmFnZUF1Y3Rpb25CaWRBY3Rpb24gPSAoeyBkZXBsb3kgfTogeyBkZXBsb3k6IERlcGxveSB9KSA9PiB7XG4gIGNvbnN0IHsgYXJncywgdGltZVRyYW5zYWN0aW9uQ3VycmVuY3lSYXRlLCBjb250cmFjdFBhY2thZ2UsIGVudHJ5UG9pbnQgfSA9XG4gICAgZGVwbG95O1xuICBjb25zdCBhbW91bnQgPSBhcmdzLmFtb3VudD8ucGFyc2VkIGFzIHN0cmluZztcblxuICByZXR1cm4gKFxuICAgIDxGbGV4Um93IGFsaWduPXsnY2VudGVyJ30gaXRlbXNTcGFjaW5nPXs4fT5cbiAgICAgIDxCb2R5VGV4dCBzaXplPXszfSBtb25vdHlwZSB2YXJpYXRpb249eydibGFjayd9PlxuICAgICAgICB7YXVjdGlvbkFjdGlvbk5hbWVNYXBbZW50cnlQb2ludD8ubmFtZSB8fCAnJ119XG4gICAgICA8L0JvZHlUZXh0PlxuICAgICAgPEF1Y3Rpb25Db250cmFjdElkZW50aWZpZXJcbiAgICAgICAgaWRlbnRpZmllcj17J0F1Y3Rpb24nfVxuICAgICAgICBjb250cmFjdF9wYWNrYWdlX2hhc2g9e2NvbnRyYWN0UGFja2FnZT8uY29udHJhY3RfcGFja2FnZV9oYXNofVxuICAgICAgLz5cbiAgICAgIDxCb2R5VGV4dCBzaXplPXszfSB2YXJpYXRpb249XCJibGFja1wiIG1vbm90eXBlPlxuICAgICAgICBiaWRcbiAgICAgIDwvQm9keVRleHQ+XG4gICAgICB7YW1vdW50ICYmIChcbiAgICAgICAgPD5cbiAgICAgICAgICA8Qm9keVRleHQgc2l6ZT17M30gdmFyaWF0aW9uPVwiZGFya0dyYXlcIj5cbiAgICAgICAgICAgIG9mXG4gICAgICAgICAgPC9Cb2R5VGV4dD5cbiAgICAgICAgICA8RGVwbG95RmlhdEFtb3VudFxuICAgICAgICAgICAgYW1vdW50PXthbW91bnR9XG4gICAgICAgICAgICByYXRlPXt0aW1lVHJhbnNhY3Rpb25DdXJyZW5jeVJhdGV9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC8+XG4gICAgICApfVxuICAgIDwvRmxleFJvdz5cbiAgKTtcbn07XG5cbmNvbnN0IERlbGVnYXRpb25BdWN0aW9uQWN0aW9uID0gKHsgZGVwbG95IH06IHsgZGVwbG95OiBEZXBsb3kgfSkgPT4ge1xuICBjb25zdCB7IHRpbWVUcmFuc2FjdGlvbkN1cnJlbmN5UmF0ZSwgZW50cnlQb2ludCwgYXJncyB9ID0gZGVwbG95O1xuXG4gIGNvbnN0IGFtb3VudCA9IGFyZ3MuYW1vdW50Py5wYXJzZWQgYXMgc3RyaW5nO1xuICBjb25zdCBpbml0aWFsVmFsaWRhdG9yUHJlZml4ID1cbiAgICBlbnRyeVBvaW50Py5uYW1lID09PSBBdWN0aW9uTWFuYWdlckVudHJ5UG9pbnQuZGVsZWdhdGUgPyAndG8nIDogJ2Zyb20nO1xuXG4gIHJldHVybiAoXG4gICAgPEZsZXhSb3cgYWxpZ249eydjZW50ZXInfSBnYXA9ezh9PlxuICAgICAgPEJvZHlUZXh0IHNpemU9ezN9IG1vbm90eXBlIHZhcmlhdGlvbj17J2JsYWNrJ30+XG4gICAgICAgIHthdWN0aW9uQWN0aW9uTmFtZU1hcFtlbnRyeVBvaW50Py5uYW1lIHx8ICcnXX1cbiAgICAgIDwvQm9keVRleHQ+XG4gICAgICB7YW1vdW50ICYmIChcbiAgICAgICAgPERlcGxveUZpYXRBbW91bnQgYW1vdW50PXthbW91bnR9IHJhdGU9e3RpbWVUcmFuc2FjdGlvbkN1cnJlbmN5UmF0ZX0gLz5cbiAgICAgICl9XG4gICAgICA8VmFsaWRhdG9yQWNjb3VudEluZm9cbiAgICAgICAgcHVibGljS2V5PXthcmdzLnZhbGlkYXRvcj8ucGFyc2VkIGFzIHN0cmluZ31cbiAgICAgICAgcHJlZml4PXtpbml0aWFsVmFsaWRhdG9yUHJlZml4fVxuICAgICAgLz5cbiAgICAgIDxWYWxpZGF0b3JBY2NvdW50SW5mb1xuICAgICAgICBwdWJsaWNLZXk9e2FyZ3MubmV3X3ZhbGlkYXRvcj8ucGFyc2VkIGFzIHN0cmluZ31cbiAgICAgICAgcHJlZml4PXsndG8nfVxuICAgICAgLz5cbiAgICA8L0ZsZXhSb3c+XG4gICk7XG59O1xuXG5jb25zdCBEZXBsb3lBY3Rpb25BdWN0aW9uID0gKHsgZGVwbG95IH06IHsgZGVwbG95OiBEZXBsb3kgfSkgPT4ge1xuICBjb25zdCB7IGVudHJ5UG9pbnQgfSA9IGRlcGxveTtcblxuICBjb25zdCBlbnRyeVBvaW50TmFtZSA9IGVudHJ5UG9pbnQ/Lm5hbWUgfHwgJyc7XG5cbiAgY29uc3QgaXNNYW5hZ2VBdWN0aW9uQmlkQWN0aW9uID1cbiAgICBlbnRyeVBvaW50TmFtZSA9PT0gQXVjdGlvbk1hbmFnZXJFbnRyeVBvaW50LmFjdGl2YXRlIHx8XG4gICAgZW50cnlQb2ludE5hbWUgPT09IEF1Y3Rpb25NYW5hZ2VyRW50cnlQb2ludC53aXRoZHJhdyB8fFxuICAgIGVudHJ5UG9pbnROYW1lID09PSBBdWN0aW9uTWFuYWdlckVudHJ5UG9pbnQuYWRkO1xuXG4gIGNvbnN0IGlzRGVsZWdhdGlvbkFjdGlvbiA9XG4gICAgZW50cnlQb2ludE5hbWUgPT09IEF1Y3Rpb25NYW5hZ2VyRW50cnlQb2ludC5kZWxlZ2F0ZSB8fFxuICAgIGVudHJ5UG9pbnROYW1lID09PSBBdWN0aW9uTWFuYWdlckVudHJ5UG9pbnQudW5kZWxlZ2F0ZSB8fFxuICAgIGVudHJ5UG9pbnROYW1lID09PSBBdWN0aW9uTWFuYWdlckVudHJ5UG9pbnQucmVkZWxlZ2F0ZTtcblxuICBpZiAoaXNEZWxlZ2F0aW9uQWN0aW9uKSB7XG4gICAgcmV0dXJuIDxEZWxlZ2F0aW9uQXVjdGlvbkFjdGlvbiBkZXBsb3k9e2RlcGxveX0gLz47XG4gIH1cblxuICBpZiAoaXNNYW5hZ2VBdWN0aW9uQmlkQWN0aW9uKSB7XG4gICAgcmV0dXJuIDxNYW5hZ2VBdWN0aW9uQmlkQWN0aW9uIGRlcGxveT17ZGVwbG95fSAvPjtcbiAgfVxuXG4gIHJldHVybiA8RGVmYXVsdEF1Y3Rpb25BY3Rpb24gZGVwbG95PXtkZXBsb3l9IC8+O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgRGVwbG95QWN0aW9uQXVjdGlvbjtcbiJdfQ==