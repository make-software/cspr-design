import { isNonNullable } from './guards';
import { deriveSplitDataFromNamedKeyValue } from './named-key';
export const getNftTokensQuantityFromArgs = (args) => {
    if (args.token_ids || args.token_metas || args.tokens) {
        return ((args.token_ids || args.token_metas || args.tokens)?.parsed ||
            []).length;
    }
    if (args.token_meta_data || args.token_id) {
        return 1;
    }
    return undefined;
};
export const getNftTokenIdsFromArguments = (args) => {
    const hasTokens = args.token_metas?.parsed || args.token_id?.parsed || args.token_ids?.parsed;
    const getTokenIdsFromClValue = (clValue) => clValue?.parsed
        ? clValue?.parsed.map((token) => typeof token === 'string' ? token : token.key)
        : [];
    if (hasTokens) {
        const tokens = [
            ...getTokenIdsFromClValue(args.token_ids),
            ...getTokenIdsFromClValue(args.token_metas),
        ];
        const ids = [...tokens, args.token_id?.parsed].filter(isNonNullable);
        return [...new Set(ids)];
    }
    return null;
};
/**
 *
 * @param argument args from Deploy
 * @param parsedKey string { deprecated }
 */
export const guardedDeriveSplitDataFromArguments = (argument, parsedKey) => {
    if (argument && argument.parsed) {
        // parse arguments for v1
        if (argument.parsed[parsedKey]) {
            return deriveSplitDataFromNamedKeyValue(argument.parsed[parsedKey]);
        }
        if (typeof argument.parsed !== 'object') {
            // parse arguments for v2
            return deriveSplitDataFromNamedKeyValue(argument.parsed);
        }
    }
    return null;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVwbG95LWFyZ3MuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbGliL3V0aWxzL2RlcGxveS1hcmdzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDekMsT0FBTyxFQUFFLGdDQUFnQyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBRS9ELE1BQU0sQ0FBQyxNQUFNLDRCQUE0QixHQUFHLENBQUMsSUFBc0IsRUFBRSxFQUFFO0lBQ3JFLElBQUksSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUN0RCxPQUFPLENBQ0osQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLE1BQWdCO1lBQ3RFLEVBQUUsQ0FDSCxDQUFDLE1BQU0sQ0FBQztJQUNYLENBQUM7SUFFRCxJQUFJLElBQUksQ0FBQyxlQUFlLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzFDLE9BQU8sQ0FBQyxDQUFDO0lBQ1gsQ0FBQztJQUVELE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxNQUFNLDJCQUEyQixHQUFHLENBQUMsSUFBSSxFQUFFLEVBQUU7SUFDbEQsTUFBTSxTQUFTLEdBQ2IsSUFBSSxDQUFDLFdBQVcsRUFBRSxNQUFNLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRSxNQUFNLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUM7SUFFOUUsTUFBTSxzQkFBc0IsR0FBRyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQ3pDLE9BQU8sRUFBRSxNQUFNO1FBQ2IsQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FDNUIsT0FBTyxLQUFLLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQzlDO1FBQ0gsQ0FBQyxDQUFDLEVBQUUsQ0FBQztJQUVULElBQUksU0FBUyxFQUFFLENBQUM7UUFDZCxNQUFNLE1BQU0sR0FBRztZQUNiLEdBQUcsc0JBQXNCLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUN6QyxHQUFHLHNCQUFzQixDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7U0FDNUMsQ0FBQztRQUNGLE1BQU0sR0FBRyxHQUFHLENBQUMsR0FBRyxNQUFNLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7UUFFckUsT0FBTyxDQUFDLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBQ0QsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDLENBQUM7QUFFRjs7OztHQUlHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sbUNBQW1DLEdBQUcsQ0FDakQsUUFBYSxFQUNiLFNBQWlCLEVBQ2pCLEVBQUU7SUFDRixJQUFJLFFBQVEsSUFBSSxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDaEMseUJBQXlCO1FBQ3pCLElBQUksUUFBUSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDO1lBQy9CLE9BQU8sZ0NBQWdDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQ3RFLENBQUM7UUFFRCxJQUFJLE9BQU8sUUFBUSxDQUFDLE1BQU0sS0FBSyxRQUFRLEVBQUUsQ0FBQztZQUN4Qyx5QkFBeUI7WUFDekIsT0FBTyxnQ0FBZ0MsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDM0QsQ0FBQztJQUNILENBQUM7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFyZ3MsIENMVmFsdWVQYXJzZXIsIENvbnZlcnNpb25zIH0gZnJvbSAnY2FzcGVyLWpzLXNkayc7XG5pbXBvcnQgeyBEZXBsb3lBcmdzUmVzdWx0IH0gZnJvbSAnLi4vdHlwZXMvdHlwZXMnO1xuaW1wb3J0IHsgaXNOb25OdWxsYWJsZSB9IGZyb20gJy4vZ3VhcmRzJztcbmltcG9ydCB7IGRlcml2ZVNwbGl0RGF0YUZyb21OYW1lZEtleVZhbHVlIH0gZnJvbSAnLi9uYW1lZC1rZXknO1xuXG5leHBvcnQgY29uc3QgZ2V0TmZ0VG9rZW5zUXVhbnRpdHlGcm9tQXJncyA9IChhcmdzOiBEZXBsb3lBcmdzUmVzdWx0KSA9PiB7XG4gIGlmIChhcmdzLnRva2VuX2lkcyB8fCBhcmdzLnRva2VuX21ldGFzIHx8IGFyZ3MudG9rZW5zKSB7XG4gICAgcmV0dXJuIChcbiAgICAgICgoYXJncy50b2tlbl9pZHMgfHwgYXJncy50b2tlbl9tZXRhcyB8fCBhcmdzLnRva2Vucyk/LnBhcnNlZCBhcyBhbnlbXSkgfHxcbiAgICAgIFtdXG4gICAgKS5sZW5ndGg7XG4gIH1cblxuICBpZiAoYXJncy50b2tlbl9tZXRhX2RhdGEgfHwgYXJncy50b2tlbl9pZCkge1xuICAgIHJldHVybiAxO1xuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXROZnRUb2tlbklkc0Zyb21Bcmd1bWVudHMgPSAoYXJncykgPT4ge1xuICBjb25zdCBoYXNUb2tlbnMgPVxuICAgIGFyZ3MudG9rZW5fbWV0YXM/LnBhcnNlZCB8fCBhcmdzLnRva2VuX2lkPy5wYXJzZWQgfHwgYXJncy50b2tlbl9pZHM/LnBhcnNlZDtcblxuICBjb25zdCBnZXRUb2tlbklkc0Zyb21DbFZhbHVlID0gKGNsVmFsdWUpID0+XG4gICAgY2xWYWx1ZT8ucGFyc2VkXG4gICAgICA/IGNsVmFsdWU/LnBhcnNlZC5tYXAoKHRva2VuKSA9PlxuICAgICAgICAgIHR5cGVvZiB0b2tlbiA9PT0gJ3N0cmluZycgPyB0b2tlbiA6IHRva2VuLmtleSxcbiAgICAgICAgKVxuICAgICAgOiBbXTtcblxuICBpZiAoaGFzVG9rZW5zKSB7XG4gICAgY29uc3QgdG9rZW5zID0gW1xuICAgICAgLi4uZ2V0VG9rZW5JZHNGcm9tQ2xWYWx1ZShhcmdzLnRva2VuX2lkcyksXG4gICAgICAuLi5nZXRUb2tlbklkc0Zyb21DbFZhbHVlKGFyZ3MudG9rZW5fbWV0YXMpLFxuICAgIF07XG4gICAgY29uc3QgaWRzID0gWy4uLnRva2VucywgYXJncy50b2tlbl9pZD8ucGFyc2VkXS5maWx0ZXIoaXNOb25OdWxsYWJsZSk7XG5cbiAgICByZXR1cm4gWy4uLm5ldyBTZXQoaWRzKV07XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xuXG4vKipcbiAqXG4gKiBAcGFyYW0gYXJndW1lbnQgYXJncyBmcm9tIERlcGxveVxuICogQHBhcmFtIHBhcnNlZEtleSBzdHJpbmcgeyBkZXByZWNhdGVkIH1cbiAqL1xuZXhwb3J0IGNvbnN0IGd1YXJkZWREZXJpdmVTcGxpdERhdGFGcm9tQXJndW1lbnRzID0gKFxuICBhcmd1bWVudDogYW55LFxuICBwYXJzZWRLZXk6IHN0cmluZyxcbikgPT4ge1xuICBpZiAoYXJndW1lbnQgJiYgYXJndW1lbnQucGFyc2VkKSB7XG4gICAgLy8gcGFyc2UgYXJndW1lbnRzIGZvciB2MVxuICAgIGlmIChhcmd1bWVudC5wYXJzZWRbcGFyc2VkS2V5XSkge1xuICAgICAgcmV0dXJuIGRlcml2ZVNwbGl0RGF0YUZyb21OYW1lZEtleVZhbHVlKGFyZ3VtZW50LnBhcnNlZFtwYXJzZWRLZXldKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGFyZ3VtZW50LnBhcnNlZCAhPT0gJ29iamVjdCcpIHtcbiAgICAgIC8vIHBhcnNlIGFyZ3VtZW50cyBmb3IgdjJcbiAgICAgIHJldHVybiBkZXJpdmVTcGxpdERhdGFGcm9tTmFtZWRLZXlWYWx1ZShhcmd1bWVudC5wYXJzZWQpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBudWxsO1xufTtcbiJdfQ==