import { __assign } from "tslib";
import { createIntl, createIntlCache } from '@formatjs/intl';
import { formatDistanceToNowStrict, formatISO } from 'date-fns';
import i18next from 'i18next';
import en from 'date-fns/locale/en-US';
import uk from 'date-fns/locale/uk';
import es from 'date-fns/locale/es';
import tr from 'date-fns/locale/tr';
import nl from 'date-fns/locale/nl';
import ru from 'date-fns/locale/ru';
import pl from 'date-fns/locale/pl';
import vi from 'date-fns/locale/vi';
import fr from 'date-fns/locale/fr';
import az from 'date-fns/locale/az';
import { isBrowserSupportRelativeDateFormat } from './detect-browser';
export var MINIMUM_SHOWING_BALANCE = 0.00001;
export var DEFAULT_AMOUNT_PRECISION = 4;
export var SMALL_PRECISION = 2;
export var DEFAULT_PRECISION = 5;
export var FULL_PRECISION = 9;
var Locale = {
    en: en,
    es: es,
    uk: uk,
    tr: tr,
    nl: nl,
    ru: ru,
    pl: pl,
    vi: vi,
    fr: fr,
    az: az,
};
var cache = createIntlCache();
var intl = createIntl({
    locale: 'en-US',
    messages: {
        'components.transaction_status': 'Success',
    },
}, cache);
export var formatMessage = function (descriptor, values) {
    return intl.formatMessage(descriptor, values);
};
export var formatNumber = function (value, _a) {
    var _b = _a === void 0 ? {} : _a, precision = _b.precision, notation = _b.notation, compactDisplay = _b.compactDisplay;
    return intl.formatNumber(value, {
        minimumFractionDigits: precision || 0,
        maximumFractionDigits: precision || 0,
        notation: notation,
        compactDisplay: compactDisplay,
    });
};
var BIG_NUMBERS_NOTATION_SYMBOL = [
    '',
    'k',
    'M',
    'B',
    'T',
    'e15',
    'e18',
    'e21',
    'e24',
    'e27',
    'e30',
    'e33',
    'e36',
    'e39',
    'e42',
    'e45',
    'e48',
    'e51',
    'e54',
    'e57',
    'e60',
    'e63',
    'e66',
    'e69',
    'e72',
    'e75',
    'e78',
    'e81',
    'e84',
    'e87',
    'e90',
    'e93',
    'e96',
    'e99',
    'e101',
    'e104', //Tretrigintillion
];
export var formatBigNumbers = function (value) {
    // determines symbol
    var tier = (Math.log10(Math.abs(value)) / 3) | 0;
    var tiersWithoutSuffixes = [0, 1, 2];
    if (tiersWithoutSuffixes.includes(tier)) {
        return formatNumber(value, {
            precision: DEFAULT_PRECISION,
        });
    }
    // get suffix and determine scale
    var suffix = BIG_NUMBERS_NOTATION_SYMBOL[tier];
    var scale = Math.pow(10, tier * 3);
    var scaledNumber = value / scale;
    return scaledNumber.toFixed(5) + suffix;
};
export var formatCurrency = function (value, code, _a) {
    var _b = _a === void 0 ? {} : _a, precision = _b.precision;
    return intl.formatNumber(value, {
        style: 'currency',
        currency: code,
        minimumFractionDigits: precision,
        maximumFractionDigits: precision,
    });
};
export var formatPercentage = function (value, _a) {
    var _b = _a === void 0 ? {} : _a, precision = _b.precision;
    return value.toFixed(precision || 2);
};
export var formatTimestamp = function (value) {
    var date = new Date(value);
    var locale = i18next.language || 'en';
    var nativeIntl = new Intl.DateTimeFormat(locale, {
        month: 'short',
        day: 'numeric',
        year: 'numeric',
        hour: 'numeric',
        minute: 'numeric',
        second: 'numeric',
        timeZoneName: 'short',
    });
    return "".concat(nativeIntl.format(date));
};
var formatDistanceTokens = {
    lessThanXSeconds: 'second',
    xSeconds: 'second',
    lessThanXMinutes: 'minute',
    xMinutes: 'minute',
    xHours: 'hour',
    xDays: 'day',
    xMonths: 'month',
    xYears: 'year',
};
var formatDistance = function (token, count, options) {
    options = options || {};
    var locale = options.locale.code || 'en';
    return new Intl.RelativeTimeFormat(locale, {
        style: 'short',
    })
        .format(-count, formatDistanceTokens[token])
        .replace('.', '');
};
export var formatTimestampAge = function (value) {
    var date = new Date(value);
    var isSupportedLanguageAndBrowser = i18next.language !== 'az' && isBrowserSupportRelativeDateFormat;
    return "".concat(formatDistanceToNowStrict(date, {
        addSuffix: true,
        locale: __assign(__assign({}, Locale[i18next.language]), (isSupportedLanguageAndBrowser && {
            formatDistance: formatDistance,
        })),
        roundingMethod: 'floor',
    }));
};
export var formatDate = function (value) {
    var date = new Date(value);
    return "".concat(intl.formatDate(date, {
        month: 'short',
        day: 'numeric',
        year: 'numeric',
    }), ", ").concat(intl.formatTime(date, {
        hour: 'numeric',
        minute: 'numeric',
    }));
};
export var formatDateWithWeekday = function (value) {
    var date = new Date(value);
    return "".concat(intl.formatDate(date, {
        month: 'short',
        day: 'numeric',
        year: 'numeric',
        weekday: 'long',
    }));
};
export var formatDateShort = function (value) {
    var date = new Date(value);
    return "".concat(intl.formatDate(date, {
        month: 'short',
        day: 'numeric',
    }));
};
export var formatDateWithMonthAndYear = function (value) {
    var date = new Date(value);
    return "".concat(intl.formatDate(date, {
        month: 'short',
        year: 'numeric',
    }));
};
export var HashLength;
(function (HashLength) {
    HashLength[HashLength["FULL"] = 0] = "FULL";
    HashLength[HashLength["TINY"] = 5] = "TINY";
    HashLength[HashLength["LITTLE"] = 10] = "LITTLE";
    HashLength[HashLength["SMALL"] = 15] = "SMALL";
    HashLength[HashLength["MEDIUM"] = 20] = "MEDIUM";
    HashLength[HashLength["LARGE"] = 25] = "LARGE";
})(HashLength || (HashLength = {}));
export var shortenString = function (valueToShort, visibleHashLength) {
    if (visibleHashLength === void 0) { visibleHashLength = HashLength.TINY; }
    var hashLength = valueToShort.length;
    var firstPart = valueToShort.substring(0, visibleHashLength);
    var secondPart = valueToShort.substring(hashLength - visibleHashLength);
    return "".concat(firstPart, "...").concat(secondPart);
};
export var formatHash = function (hash, visibleHashLength) {
    if (visibleHashLength === void 0) { visibleHashLength = HashLength.TINY; }
    var MIN_TRUNCATE_HASH_LENGTH = HashLength.TINY * 2 + 3;
    var _a = hash.split('-'), hashWithoutSuffix = _a[0], lastDigits = _a[1];
    var hashLength = hashWithoutSuffix.length;
    if (visibleHashLength === HashLength.FULL ||
        hashLength <= MIN_TRUNCATE_HASH_LENGTH) {
        return hash;
    }
    var truncatedHash = shortenString(hashWithoutSuffix, visibleHashLength);
    return lastDigits ? "".concat(truncatedHash, "-").concat(lastDigits) : "".concat(truncatedHash);
};
export var formatISODateOnly = function (date) {
    return formatISO(date, {
        representation: 'date',
    });
};
export var formatDeploysCount = function (value) {
    return "".concat(formatNumber(value, {
        notation: 'compact',
        compactDisplay: 'short',
    }));
};
export var formatRatesToCurrency = function (value) {
    return formatNumber(value, { precision: 4 });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybWF0dGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvdXRpbHMvZm9ybWF0dGVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxlQUFlLEVBQXFCLE1BQU0sZ0JBQWdCLENBQUM7QUFDaEYsT0FBTyxFQUFFLHlCQUF5QixFQUFFLFNBQVMsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUNoRSxPQUFPLE9BQU8sTUFBTSxTQUFTLENBQUM7QUFFOUIsT0FBTyxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDdkMsT0FBTyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEMsT0FBTyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEMsT0FBTyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEMsT0FBTyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEMsT0FBTyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEMsT0FBTyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEMsT0FBTyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEMsT0FBTyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEMsT0FBTyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEMsT0FBTyxFQUFFLGtDQUFrQyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFdEUsTUFBTSxDQUFDLElBQU0sdUJBQXVCLEdBQUcsT0FBTyxDQUFDO0FBQy9DLE1BQU0sQ0FBQyxJQUFNLHdCQUF3QixHQUFHLENBQUMsQ0FBQztBQUMxQyxNQUFNLENBQUMsSUFBTSxlQUFlLEdBQUcsQ0FBQyxDQUFDO0FBQ2pDLE1BQU0sQ0FBQyxJQUFNLGlCQUFpQixHQUFHLENBQUMsQ0FBQztBQUNuQyxNQUFNLENBQUMsSUFBTSxjQUFjLEdBQUcsQ0FBQyxDQUFDO0FBRWhDLElBQU0sTUFBTSxHQUFHO0lBQ2IsRUFBRSxFQUFFLEVBQUU7SUFDTixFQUFF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QUFDO0tBQ2I7SUFFRCxJQUFNLGFBQWEsR0FBRyxhQUFhLENBQUMsaUJBQWlCLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztJQUUxRSxPQUFPLFVBQVUsQ0FBQyxDQUFDLENBQUMsVUFBRyxhQUFhLGNBQUksVUFBVSxDQUFFLENBQUMsQ0FBQyxDQUFDLFVBQUcsYUFBYSxDQUFFLENBQUM7QUFDNUUsQ0FBQyxDQUFDO0FBRUYsTUFBTSxDQUFDLElBQU0saUJBQWlCLEdBQUcsVUFBQyxJQUFVO0lBQzFDLE9BQU8sU0FBUyxDQUFDLElBQUksRUFBRTtRQUNyQixjQUFjLEVBQUUsTUFBTTtLQUN2QixDQUFDLENBQUM7QUFDTCxDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsSUFBTSxrQkFBa0IsR0FBRyxVQUFDLEtBQUs7SUFDdEMsT0FBQSxVQUFHLFlBQVksQ0FBQyxLQUFLLEVBQUU7UUFDckIsUUFBUSxFQUFFLFNBQVM7UUFDbkIsY0FBYyxFQUFFLE9BQU87S0FDeEIsQ0FBQyxDQUFFO0FBSEosQ0FHSSxDQUFDO0FBRVAsTUFBTSxDQUFDLElBQU0scUJBQXFCLEdBQUcsVUFBQyxLQUFLO0lBQ3pDLE9BQUEsWUFBWSxDQUFDLEtBQUssRUFBRSxFQUFFLFNBQVMsRUFBRSxDQUFDLEVBQUUsQ0FBQztBQUFyQyxDQUFxQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlSW50bCwgY3JlYXRlSW50bENhY2hlLCBNZXNzYWdlRGVzY3JpcHRvciB9IGZyb20gJ0Bmb3JtYXRqcy9pbnRsJztcbmltcG9ydCB7IGZvcm1hdERpc3RhbmNlVG9Ob3dTdHJpY3QsIGZvcm1hdElTTyB9IGZyb20gJ2RhdGUtZm5zJztcbmltcG9ydCBpMThuZXh0IGZyb20gJ2kxOG5leHQnO1xuXG5pbXBvcnQgZW4gZnJvbSAnZGF0ZS1mbnMvbG9jYWxlL2VuLVVTJztcbmltcG9ydCB1ayBmcm9tICdkYXRlLWZucy9sb2NhbGUvdWsnO1xuaW1wb3J0IGVzIGZyb20gJ2RhdGUtZm5zL2xvY2FsZS9lcyc7XG5pbXBvcnQgdHIgZnJvbSAnZGF0ZS1mbnMvbG9jYWxlL3RyJztcbmltcG9ydCBubCBmcm9tICdkYXRlLWZucy9sb2NhbGUvbmwnO1xuaW1wb3J0IHJ1IGZyb20gJ2RhdGUtZm5zL2xvY2FsZS9ydSc7XG5pbXBvcnQgcGwgZnJvbSAnZGF0ZS1mbnMvbG9jYWxlL3BsJztcbmltcG9ydCB2aSBmcm9tICdkYXRlLWZucy9sb2NhbGUvdmknO1xuaW1wb3J0IGZyIGZyb20gJ2RhdGUtZm5zL2xvY2FsZS9mcic7XG5pbXBvcnQgYXogZnJvbSAnZGF0ZS1mbnMvbG9jYWxlL2F6JztcbmltcG9ydCB7IGlzQnJvd3NlclN1cHBvcnRSZWxhdGl2ZURhdGVGb3JtYXQgfSBmcm9tICcuL2RldGVjdC1icm93c2VyJztcblxuZXhwb3J0IGNvbnN0IE1JTklNVU1fU0hPV0lOR19CQUxBTkNFID0gMC4wMDAwMTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0FNT1VOVF9QUkVDSVNJT04gPSA0O1xuZXhwb3J0IGNvbnN0IFNNQUxMX1BSRUNJU0lPTiA9IDI7XG5leHBvcnQgY29uc3QgREVGQVVMVF9QUkVDSVNJT04gPSA1O1xuZXhwb3J0IGNvbnN0IEZVTExfUFJFQ0lTSU9OID0gOTtcblxuY29uc3QgTG9jYWxlID0ge1xuICBlbjogZW4sXG4gIGVzOiBlcyxcbiAgdWs6IHVrLFxuICB0cjogdHIsXG4gIG5sOiBubCxcbiAgcnU6IHJ1LFxuICBwbDogcGwsXG4gIHZpOiB2aSxcbiAgZnI6IGZyLFxuICBhejogYXosXG59O1xuXG5jb25zdCBjYWNoZSA9IGNyZWF0ZUludGxDYWNoZSgpO1xuY29uc3QgaW50bCA9IGNyZWF0ZUludGwoXG4gIHtcbiAgICBsb2NhbGU6ICdlbi1VUycsXG4gICAgbWVzc2FnZXM6IHtcbiAgICAgICdjb21wb25lbnRzLnRyYW5zYWN0aW9uX3N0YXR1cyc6ICdTdWNjZXNzJyxcbiAgICB9LFxuICB9LFxuICBjYWNoZVxuKTtcblxuZXhwb3J0IGNvbnN0IGZvcm1hdE1lc3NhZ2UgPSAoXG4gIGRlc2NyaXB0b3I6IE1lc3NhZ2VEZXNjcmlwdG9yLFxuICB2YWx1ZXM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pOiBzdHJpbmcgPT4ge1xuICByZXR1cm4gaW50bC5mb3JtYXRNZXNzYWdlKGRlc2NyaXB0b3IsIHZhbHVlcyk7XG59O1xuXG5leHBvcnQgY29uc3QgZm9ybWF0TnVtYmVyID0gKFxuICB2YWx1ZTogbnVtYmVyIHwgc3RyaW5nLFxuICB7XG4gICAgcHJlY2lzaW9uLFxuICAgIG5vdGF0aW9uLFxuICAgIGNvbXBhY3REaXNwbGF5LFxuICB9OiB7XG4gICAgcHJlY2lzaW9uPzogbnVtYmVyO1xuICAgIG5vdGF0aW9uPzogJ2NvbXBhY3QnIHwgJ3N0YW5kYXJkJztcbiAgICBjb21wYWN0RGlzcGxheT86ICdzaG9ydCcgfCAnbG9uZyc7XG4gIH0gPSB7fVxuKTogc3RyaW5nID0+IHtcbiAgcmV0dXJuIGludGwuZm9ybWF0TnVtYmVyKHZhbHVlIGFzIG51bWJlciwge1xuICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogcHJlY2lzaW9uIHx8IDAsXG4gICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiBwcmVjaXNpb24gfHwgMCxcbiAgICBub3RhdGlvbixcbiAgICBjb21wYWN0RGlzcGxheSxcbiAgfSk7XG59O1xuXG5jb25zdCBCSUdfTlVNQkVSU19OT1RBVElPTl9TWU1CT0wgPSBbXG4gICcnLFxuICAnaycsIC8vVGhvdXNhbmRcbiAgJ00nLCAvL01pbGxpb25cbiAgJ0InLCAvL0JpbGxpb25cbiAgJ1QnLCAvL1RyaWxsaW9uXG4gICdlMTUnLCAvL1F1YWRyaWxsaW9uXG4gICdlMTgnLCAvL1F1aW50aWxsaW9uXG4gICdlMjEnLCAvL1NleHRpbGxpb25cbiAgJ2UyNCcsIC8vU2VwdGlsbGlvblxuICAnZTI3JywgLy9PY3RpbGxpb25cbiAgJ2UzMCcsIC8vTm9uaWxsaW9uXG4gICdlMzMnLCAvL0RlY2lsbGlvblxuICAnZTM2JywgLy9VbmRlY2lsbGlvblxuICAnZTM5JywgLy9EdW9kZWNpbGxpb25cbiAgJ2U0MicsIC8vVHJlZGVjaWxsaW9uXG4gICdlNDUnLCAvL1F1YXR0dW9yZGVjaWxsaW9uXG4gICdlNDgnLCAvL1F1aW5kZWNpbGxpb25cbiAgJ2U1MScsIC8vU2V4ZGVjaWxsaW9uXG4gICdlNTQnLCAvL1NlcHRlbmRlY2lsbGlvblxuICAnZTU3JywgLy9PY3RvZGVjaWxsaW9uXG4gICdlNjAnLCAvL05vdmVtZGVjaWxsaW9uXG4gICdlNjMnLCAvL1ZpZ2ludGlsbGlvblxuICAnZTY2JywgLy9VbnZpZ2ludGlsbGlvblxuICAnZTY5JywgLy9EdW92aWdpbnRpbGxpb25cbiAgJ2U3MicsIC8vVHJldmlnaW50aWxsaW9uXG4gICdlNzUnLCAvL1F1YXR0dW9ydmlnaW50aWxsaW9uXG4gICdlNzgnLCAvL1F1aW52aWdpbnRpbGxpb25cbiAgJ2U4MScsIC8vU2V4dmlnaW50aWxsaW9uXG4gICdlODQnLCAvL1NlcHRlbnZpZ2ludGlsbGlvblxuICAnZTg3JywgLy9PY3RvdmlnaW50aWxsaW9uXG4gICdlOTAnLCAvL05vdmVtdmlnaW50aWxsaW9uXG4gICdlOTMnLCAvL1RyaWdpbnRpbGxpb25cbiAgJ2U5NicsIC8vVW50cmlnaW50aWxsaW9uXG4gICdlOTknLCAvL0R1b3RyaWdpbnRpbGxpb25cbiAgJ2UxMDEnLCAvL0dvb2dvbFxuICAnZTEwNCcsIC8vVHJldHJpZ2ludGlsbGlvblxuXTtcblxuZXhwb3J0IGNvbnN0IGZvcm1hdEJpZ051bWJlcnMgPSAodmFsdWUpID0+IHtcbiAgLy8gZGV0ZXJtaW5lcyBzeW1ib2xcbiAgY29uc3QgdGllciA9IChNYXRoLmxvZzEwKE1hdGguYWJzKHZhbHVlKSkgLyAzKSB8IDA7XG4gIGNvbnN0IHRpZXJzV2l0aG91dFN1ZmZpeGVzID0gWzAsIDEsIDJdO1xuXG4gIGlmICh0aWVyc1dpdGhvdXRTdWZmaXhlcy5pbmNsdWRlcyh0aWVyKSkge1xuICAgIHJldHVybiBmb3JtYXROdW1iZXIodmFsdWUsIHtcbiAgICAgIHByZWNpc2lvbjogREVGQVVMVF9QUkVDSVNJT04sXG4gICAgfSk7XG4gIH1cblxuICAvLyBnZXQgc3VmZml4IGFuZCBkZXRlcm1pbmUgc2NhbGVcbiAgY29uc3Qgc3VmZml4ID0gQklHX05VTUJFUlNfTk9UQVRJT05fU1lNQk9MW3RpZXJdO1xuICBjb25zdCBzY2FsZSA9IE1hdGgucG93KDEwLCB0aWVyICogMyk7XG5cbiAgY29uc3Qgc2NhbGVkTnVtYmVyID0gdmFsdWUgLyBzY2FsZTtcblxuICByZXR1cm4gc2NhbGVkTnVtYmVyLnRvRml4ZWQoNSkgKyBzdWZmaXg7XG59O1xuXG5leHBvcnQgY29uc3QgZm9ybWF0Q3VycmVuY3kgPSAoXG4gIHZhbHVlOiBudW1iZXIgfCBzdHJpbmcsXG4gIGNvZGU6IHN0cmluZyxcbiAge1xuICAgIHByZWNpc2lvbixcbiAgfToge1xuICAgIHByZWNpc2lvbj86IG51bWJlcjtcbiAgfSA9IHt9XG4pOiBzdHJpbmcgPT4ge1xuICByZXR1cm4gaW50bC5mb3JtYXROdW1iZXIodmFsdWUgYXMgbnVtYmVyLCB7XG4gICAgc3R5bGU6ICdjdXJyZW5jeScsXG4gICAgY3VycmVuY3k6IGNvZGUsXG4gICAgbWluaW11bUZyYWN0aW9uRGlnaXRzOiBwcmVjaXNpb24sXG4gICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiBwcmVjaXNpb24sXG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGZvcm1hdFBlcmNlbnRhZ2UgPSAoXG4gIHZhbHVlOiBudW1iZXIsXG4gIHsgcHJlY2lzaW9uIH06IHsgcHJlY2lzaW9uPzogbnVtYmVyIH0gPSB7fVxuKSA9PiB7XG4gIHJldHVybiB2YWx1ZS50b0ZpeGVkKHByZWNpc2lvbiB8fCAyKTtcbn07XG5cbmV4cG9ydCBjb25zdCBmb3JtYXRUaW1lc3RhbXAgPSAodmFsdWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh2YWx1ZSk7XG4gIGNvbnN0IGxvY2FsZSA9IGkxOG5leHQubGFuZ3VhZ2UgfHwgJ2VuJztcbiAgY29uc3QgbmF0aXZlSW50bCA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KGxvY2FsZSwge1xuICAgIG1vbnRoOiAnc2hvcnQnLFxuICAgIGRheTogJ251bWVyaWMnLFxuICAgIHllYXI6ICdudW1lcmljJyxcbiAgICBob3VyOiAnbnVtZXJpYycsXG4gICAgbWludXRlOiAnbnVtZXJpYycsXG4gICAgc2Vjb25kOiAnbnVtZXJpYycsXG4gICAgdGltZVpvbmVOYW1lOiAnc2hvcnQnLFxuICB9KTtcblxuICByZXR1cm4gYCR7bmF0aXZlSW50bC5mb3JtYXQoZGF0ZSl9YDtcbn07XG5cbmNvbnN0IGZvcm1hdERpc3RhbmNlVG9rZW5zID0ge1xuICBsZXNzVGhhblhTZWNvbmRzOiAnc2Vjb25kJyxcbiAgeFNlY29uZHM6ICdzZWNvbmQnLFxuICBsZXNzVGhhblhNaW51dGVzOiAnbWludXRlJyxcbiAgeE1pbnV0ZXM6ICdtaW51dGUnLFxuICB4SG91cnM6ICdob3VyJyxcbiAgeERheXM6ICdkYXknLFxuICB4TW9udGhzOiAnbW9udGgnLFxuICB4WWVhcnM6ICd5ZWFyJyxcbn07XG5cbmNvbnN0IGZvcm1hdERpc3RhbmNlID0gKHRva2VuLCBjb3VudCwgb3B0aW9ucykgPT4ge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgY29uc3QgbG9jYWxlID0gb3B0aW9ucy5sb2NhbGUuY29kZSB8fCAnZW4nO1xuXG4gIHJldHVybiBuZXcgKEludGwgYXMgYW55KS5SZWxhdGl2ZVRpbWVGb3JtYXQobG9jYWxlLCB7XG4gICAgc3R5bGU6ICdzaG9ydCcsXG4gIH0pXG4gICAgLmZvcm1hdCgtY291bnQsIGZvcm1hdERpc3RhbmNlVG9rZW5zW3Rva2VuXSlcbiAgICAucmVwbGFjZSgnLicsICcnKTtcbn07XG5cbmV4cG9ydCBjb25zdCBmb3JtYXRUaW1lc3RhbXBBZ2UgPSAodmFsdWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh2YWx1ZSk7XG4gIGNvbnN0IGlzU3VwcG9ydGVkTGFuZ3VhZ2VBbmRCcm93c2VyID1cbiAgICBpMThuZXh0Lmxhbmd1YWdlICE9PSAnYXonICYmIGlzQnJvd3NlclN1cHBvcnRSZWxhdGl2ZURhdGVGb3JtYXQ7XG5cbiAgcmV0dXJuIGAke2Zvcm1hdERpc3RhbmNlVG9Ob3dTdHJpY3QoZGF0ZSwge1xuICAgIGFkZFN1ZmZpeDogdHJ1ZSxcbiAgICBsb2NhbGU6IHtcbiAgICAgIC4uLkxvY2FsZVtpMThuZXh0Lmxhbmd1YWdlXSxcbiAgICAgIC4uLihpc1N1cHBvcnRlZExhbmd1YWdlQW5kQnJvd3NlciAmJiB7XG4gICAgICAgIGZvcm1hdERpc3RhbmNlLFxuICAgICAgfSksXG4gICAgfSxcbiAgICByb3VuZGluZ01ldGhvZDogJ2Zsb29yJyxcbiAgfSl9YDtcbn07XG5cbmV4cG9ydCBjb25zdCBmb3JtYXREYXRlID0gKHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpOiBzdHJpbmcgPT4ge1xuICBjb25zdCBkYXRlID0gbmV3IERhdGUodmFsdWUpO1xuICByZXR1cm4gYCR7aW50bC5mb3JtYXREYXRlKGRhdGUsIHtcbiAgICBtb250aDogJ3Nob3J0JyxcbiAgICBkYXk6ICdudW1lcmljJyxcbiAgICB5ZWFyOiAnbnVtZXJpYycsXG4gIH0pfSwgJHtpbnRsLmZvcm1hdFRpbWUoZGF0ZSwge1xuICAgIGhvdXI6ICdudW1lcmljJyxcbiAgICBtaW51dGU6ICdudW1lcmljJyxcbiAgfSl9YDtcbn07XG5cbmV4cG9ydCBjb25zdCBmb3JtYXREYXRlV2l0aFdlZWtkYXkgPSAodmFsdWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh2YWx1ZSk7XG4gIHJldHVybiBgJHtpbnRsLmZvcm1hdERhdGUoZGF0ZSwge1xuICAgIG1vbnRoOiAnc2hvcnQnLFxuICAgIGRheTogJ251bWVyaWMnLFxuICAgIHllYXI6ICdudW1lcmljJyxcbiAgICB3ZWVrZGF5OiAnbG9uZycsXG4gIH0pfWA7XG59O1xuXG5leHBvcnQgY29uc3QgZm9ybWF0RGF0ZVNob3J0ID0gKHZhbHVlOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICBjb25zdCBkYXRlID0gbmV3IERhdGUodmFsdWUpO1xuICByZXR1cm4gYCR7aW50bC5mb3JtYXREYXRlKGRhdGUsIHtcbiAgICBtb250aDogJ3Nob3J0JyxcbiAgICBkYXk6ICdudW1lcmljJyxcbiAgfSl9YDtcbn07XG5cbmV4cG9ydCBjb25zdCBmb3JtYXREYXRlV2l0aE1vbnRoQW5kWWVhciA9ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHZhbHVlKTtcbiAgcmV0dXJuIGAke2ludGwuZm9ybWF0RGF0ZShkYXRlLCB7XG4gICAgbW9udGg6ICdzaG9ydCcsXG4gICAgeWVhcjogJ251bWVyaWMnLFxuICB9KX1gO1xufTtcblxuZXhwb3J0IGVudW0gSGFzaExlbmd0aCB7XG4gIEZVTEwgPSAwLFxuICBUSU5ZID0gNSxcbiAgTElUVExFID0gMTAsXG4gIFNNQUxMID0gMTUsXG4gIE1FRElVTSA9IDIwLFxuICBMQVJHRSA9IDI1LFxufVxuXG5leHBvcnQgY29uc3Qgc2hvcnRlblN0cmluZyA9IChcbiAgdmFsdWVUb1Nob3J0OiBzdHJpbmcsXG4gIHZpc2libGVIYXNoTGVuZ3RoOiBIYXNoTGVuZ3RoID0gSGFzaExlbmd0aC5USU5ZXG4pID0+IHtcbiAgY29uc3QgaGFzaExlbmd0aCA9IHZhbHVlVG9TaG9ydC5sZW5ndGg7XG4gIGNvbnN0IGZpcnN0UGFydCA9IHZhbHVlVG9TaG9ydC5zdWJzdHJpbmcoMCwgdmlzaWJsZUhhc2hMZW5ndGgpO1xuICBjb25zdCBzZWNvbmRQYXJ0ID0gdmFsdWVUb1Nob3J0LnN1YnN0cmluZyhoYXNoTGVuZ3RoIC0gdmlzaWJsZUhhc2hMZW5ndGgpO1xuXG4gIHJldHVybiBgJHtmaXJzdFBhcnR9Li4uJHtzZWNvbmRQYXJ0fWA7XG59O1xuXG5leHBvcnQgY29uc3QgZm9ybWF0SGFzaCA9IChcbiAgaGFzaDogc3RyaW5nLFxuICB2aXNpYmxlSGFzaExlbmd0aDogSGFzaExlbmd0aCA9IEhhc2hMZW5ndGguVElOWVxuKSA9PiB7XG4gIGNvbnN0IE1JTl9UUlVOQ0FURV9IQVNIX0xFTkdUSCA9IEhhc2hMZW5ndGguVElOWSAqIDIgKyAzO1xuXG4gIGNvbnN0IFtoYXNoV2l0aG91dFN1ZmZpeCwgbGFzdERpZ2l0c10gPSBoYXNoLnNwbGl0KCctJyk7XG5cbiAgY29uc3QgaGFzaExlbmd0aCA9IGhhc2hXaXRob3V0U3VmZml4Lmxlbmd0aDtcblxuICBpZiAoXG4gICAgdmlzaWJsZUhhc2hMZW5ndGggPT09IEhhc2hMZW5ndGguRlVMTCB8fFxuICAgIGhhc2hMZW5ndGggPD0gTUlOX1RSVU5DQVRFX0hBU0hfTEVOR1RIXG4gICkge1xuICAgIHJldHVybiBoYXNoO1xuICB9XG5cbiAgY29uc3QgdHJ1bmNhdGVkSGFzaCA9IHNob3J0ZW5TdHJpbmcoaGFzaFdpdGhvdXRTdWZmaXgsIHZpc2libGVIYXNoTGVuZ3RoKTtcblxuICByZXR1cm4gbGFzdERpZ2l0cyA/IGAke3RydW5jYXRlZEhhc2h9LSR7bGFzdERpZ2l0c31gIDogYCR7dHJ1bmNhdGVkSGFzaH1gO1xufTtcblxuZXhwb3J0IGNvbnN0IGZvcm1hdElTT0RhdGVPbmx5ID0gKGRhdGU6IERhdGUpOiBzdHJpbmcgPT4ge1xuICByZXR1cm4gZm9ybWF0SVNPKGRhdGUsIHtcbiAgICByZXByZXNlbnRhdGlvbjogJ2RhdGUnLFxuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBmb3JtYXREZXBsb3lzQ291bnQgPSAodmFsdWUpOiBzdHJpbmcgPT5cbiAgYCR7Zm9ybWF0TnVtYmVyKHZhbHVlLCB7XG4gICAgbm90YXRpb246ICdjb21wYWN0JyxcbiAgICBjb21wYWN0RGlzcGxheTogJ3Nob3J0JyxcbiAgfSl9YDtcblxuZXhwb3J0IGNvbnN0IGZvcm1hdFJhdGVzVG9DdXJyZW5jeSA9ICh2YWx1ZSk6IHN0cmluZyA9PlxuICBmb3JtYXROdW1iZXIodmFsdWUsIHsgcHJlY2lzaW9uOiA0IH0pO1xuIl19